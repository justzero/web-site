function getListener(e,t,n){var r;t=t.toLowerCase();return(r=e.__allListeners||n&&(e.__allListeners={}))&&(r[t]||n&&(r[t]=[]))}function getDomNode(e,t,n,r,i,s){var o=r&&e[t],u;!o&&(o=e[n]);while(!o&&(u=(u||e).parentNode)){if(u.tagName=="BODY"||s&&!s(u))return null;o=u[n]}return o&&i&&!i(o)?getDomNode(o,t,n,!1,i):o}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor={};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE.version="1.2.5.0";var dom=UE.dom={},browser=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:!!window.ActiveXObject,opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"};n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera;var r=0;if(n.ie){r=parseFloat(e.match(/msie (\d+)/)[1]);n.ie9Compat=document.documentMode==9;n.ie8=!!document.documentMode;n.ie8Compat=document.documentMode==8;n.ie7Compat=r==7&&!document.documentMode||document.documentMode==7;n.ie6Compat=r<7||n.quirks}if(n.gecko){var i=e.match(/rv:([\d\.]+)/);if(i){i=i[1].split(".");r=i[0]*1e4+(i[1]||0)*100+(i[2]||0)*1}}/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1);/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2));n.opera&&(r=parseFloat(t.version()));n.webkit&&(r=parseFloat(e.match(/ applewebkit\/(\d+)/)[1]));n.version=r;n.isCompatible=!n.mobile&&(n.ie&&r>=6||n.gecko&&r>=10801||n.opera&&r>=9.5||n.air&&r>=1||n.webkit&&r>=522||!1);return n}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera,utils=UE.utils={each:function(e,t,n){if(e==null)return;if(e.length===+e.length){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e)===!1)return!1}else for(var s in e)if(e.hasOwnProperty(s)&&t.call(n,e[s],s,e)===!1)return!1},makeInstance:function(e){var t=new Function;t.prototype=e;e=new t;t.prototype=null;return e},extend:function(e,t,n){if(t)for(var r in t)if(!n||!e.hasOwnProperty(r))e[r]=t[r];return e},inherits:function(e,t){var n=e.prototype,r=utils.makeInstance(t.prototype);utils.extend(r,n,!0);e.prototype=r;return r.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var r;return function(){n&&clearTimeout(r);r=setTimeout(e,t)}},indexOf:function(e,t,n){var r=-1;n=this.isNumber(n)?n:0;this.each(e,function(e,i){if(i>=n&&e===t){r=i;return!1}});return r},removeItem:function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t){e.splice(n,1);n--}},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=utils.isArray(e)?e:e.split(",");for(var t=0,n,r={};n=e[t++];)r[n.toUpperCase()]=r[n]=1;return r},unhtml:function(e,t){return e?e.replace(t||/[&<">]/g,function(e){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">"}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":e.cssFloat!=undefined?"cssFloat":e.styleFloat!=undefined?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function t(t,n){try{for(var r=0,i;i=e[r++];)if(i.doc===t&&i.url==(n.src||n.href))return i}catch(s){return null}}var e=[];return function(n,r,i){var s=t(n,r);if(s){s.ready?i&&i():s.funs.push(i);return}e.push({doc:n,url:r.src||r.href,funs:[i]});if(!n.body){var o=[];for(var u in r){if(u=="tag")continue;o.push(u+'="'+r[u]+'"')}n.write("<"+r.tag+" "+o.join(" ")+" ></"+r.tag+">");return}if(r.id&&n.getElementById(r.id))return;var a=n.createElement(r.tag);delete r.tag;for(var u in r)a.setAttribute(u,r[u]);a.onload=a.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){s=t(n,r);if(s.funs.length>0){s.ready=1;for(var e;e=s.funs.pop();)e()}a.onload=a.onreadystatechange=null}};a.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file editor_config.js ")};n.getElementsByTagName("head")[0].appendChild(a)}}(),isEmptyObject:function(e){if(e==null)return!0;if(this.isArray(e)||this.isString(e))return e.length===0;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var r=0,i;i=n[r++];){i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16);t+=i.length==1?"0"+i:i}t=t.toUpperCase()}return t},optCss:function(e){function i(e,t){if(!e)return"";var n=e.top,r=e.bottom,i=e.left,s=e.right,o="";if(!n||!i||!r||!s)for(var u in e)o+=";"+t+"-"+u+":"+e[u]+";";else o+=";"+t+":"+(n==r&&r==i&&i==s?n:n==r&&i==s?n+" "+i:i==s?n+" "+i+" "+r:n+" "+s+" "+r+" "+i)+";";return o}var t,n,r;e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,r,i,s){if(s.split(" ").length==1)switch(r){case"padding":!t&&(t={});t[i]=s;return"";case"margin":!n&&(n={});n[i]=s;return"";case"border":return s=="initial"?"":e}return e});e+=i(t,"padding")+i(n,"margin");return e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var n;t=t||{};for(var r in e)if(e.hasOwnProperty(r)){n=e[r];if(typeof n=="object"){t[r]=utils.isArray(n)?[]:{};utils.clone(e[r],t[r])}else t[r]=n}return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;e.replace(/([\d.]+)(\w+)/,function(n,r,i){e=r;t=i});switch(t){case"cm":e=parseFloat(e)*25;break;case"pt":e=Math.round(parseFloat(e)*96/72)}return e+(e?"px":"")},domReady:function(){function t(t){t.isReady=!0;for(var n;n=e.pop();n());}var e=[];return function(n,r){r=r||window;var i=r.document;n&&e.push(n);if(i.readyState==="complete")t(i);else{i.isReady&&t(i);if(browser.ie){(function(){if(i.isReady)return;try{i.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}t(i)})();r.attachEvent("onload",function(){t(i)})}else{i.addEventListener("DOMContentLoaded",function(){i.removeEventListener("DOMContentLoaded",arguments.callee,!1);t(i)},!1);r.addEventListener("load",function(){t(i)},!1)}}}}(),cssRule:browser.ie?function(e,t,n){var r,i;n=n||document;n.indexList?r=n.indexList:r=n.indexList={};var s;if(!r[e]){if(t===undefined)return"";s=n.createStyleSheet("",i=n.styleSheets.length);r[e]=i}else s=n.styleSheets[r[e]];if(t===undefined)return s.cssText;s.cssText=t||""}:function(e,t,n){n=n||document;var r=n.getElementsByTagName("head")[0],i;if(!(i=n.getElementById(e))){if(t===undefined)return"";i=n.createElement("style");i.id=e;r.appendChild(i)}if(t===undefined)return i.innerHTML;t!==""?i.innerHTML=t:r.removeChild(i)}};utils.each(["String","Function","Array","Number","RegExp"],function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(e,t){e=utils.trim(e).split(" ");for(var n=0,r;r=e[n++];)getListener(this,r,!0).push(t)},removeListener:function(e,t){e=utils.trim(e).split(" ");for(var n=0,r;r=e[n++];)utils.removeItem(getListener(this,r)||[],t)},fireEvent:function(e){e=utils.trim(e).split(" ");for(var t=0,n;n=e[t++];){var r=getListener(this,n),i,s,o;if(r){o=r.length;while(o--){if(!r[o])continue;s=r[o].apply(this,arguments);if(s===!0)return s;s!==undefined&&(i=s)}}if(s=this["on"+n.toLowerCase()])i=s.apply(this,arguments)}return i}};UE.ajax=function(){function r(e){var t=[];for(var n in e){if(n=="method"||n=="timeout"||n=="async")continue;(typeof e[n]).toLowerCase()!="function"&&(typeof e[n]).toLowerCase()!="object"&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}return t.join("&")}var e="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");e="ActiveXObject('Msxml2.XMLHTTP')"}catch(t){try{new ActiveXObject("Microsoft.XMLHTTP");e="ActiveXObject('Microsoft.XMLHTTP')"}catch(t){}}var n=new Function("return new "+e);return{request:function(e,t){var i=n(),s=!1,o={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};if(typeof e=="object"){t=e;e=t.url}if(!i||!e)return;var u=t?utils.extend(o,t):o,a=r(u);utils.isEmptyObject(u.data)||(a+=(a?"&":"")+r(u.data));var f=setTimeout(function(){if(i.readyState!=4){s=!0;i.abort();clearTimeout(f)}},u.timeout),l=u.method.toUpperCase(),c=e+(e.indexOf("?")==-1?"?":"&")+(l=="POST"?"":a+"&noCache="+ +(new Date));i.open(l,c,u.async);i.onreadystatechange=function(){i.readyState==4&&(!s&&i.status==200?u.onsuccess(i):u.onerror(i))};if(l=="POST"){i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");i.send(a)}else i.send(null)}}}();var filterWord=UE.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig.test(e)}function t(e){e=e.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)});return e}function n(e){return e.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(browser.opera)return"";try{var n=e.match(/width:([ \d.]*p[tx])/i)[1],r=e.match(/height:([ \d.]*p[tx])/i)[1],i=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(n)+'" height="'+t(r)+'" src="'+i+'" />'}catch(s){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)[\w-]+\2/ig,"").replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,n,r,i){var s=[],o=i.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g);for(var u=0,a;a=o[u];u++){var f,l,c=a.split(":");if(c.length==2){f=c[0].toLowerCase();l=c[1].toLowerCase();if(/^(background)\w*/.test(f)&&l.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(f)&&/^0\w+$/.test(l))continue;switch(f){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(n)||(s[u]=f.replace(/^mso-|-alt$/g,"")+":"+t(l));continue;case"horiz-align":s[u]="text-align:"+l;continue;case"vert-align":s[u]="vertical-align:"+l;continue;case"font-color":case"mso-foreground":s[u]="color:"+l;continue;case"mso-background":case"mso-highlight":s[u]="background:"+l;continue;case"mso-default-height":s[u]="min-height:"+t(l);continue;case"mso-default-width":s[u]="min-width:"+t(l);continue;case"mso-padding-between-alt":s[u]="border-collapse:separate;border-spacing:"+t(l);continue;case"text-line-through":if(l=="single"||l=="double")s[u]="text-decoration:line-through";continue;case"mso-zero-height":l=="yes"&&(s[u]="display:none");continue;case"background":l=="initial";break;case"margin":if(!/[1-9]/.test(l))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(f)||/text\-indent|padding|margin/.test(f)&&/\-[\d.]+/.test(l))continue;s[u]=f+":"+c[1]}}return n+(s.length?' style="'+s.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)})}return function(t){return(e(t)?n(t):t).replace(/>[ \t\r\n]*</g,"><")}}(),dtd=dom.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}function t(e){var t=arguments;for(var n=1;n<t.length;n++){var r=t[n];for(var i in r)e.hasOwnProperty(i)||(e[i]=r[i])}return e}var n=e({isindex:1,fieldset:1}),r=e({input:1,button:1,select:1,textarea:1,label:1}),i=t(e({a:1}),r),s=t({iframe:1},i),o=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),u=e({ins:1,del:1,script:1,style:1}),a=t(e({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),u),f=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),a),l=t(e({p:1}),f),c=t(e({iframe:1}),f,r),h=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),p=t(e({a:0}),c),d=e({tr:1}),v=e({"#":1}),m=t(e({param:1}),h),g=t(e({form:1}),n,s,o,l),y=e({li:1}),b=e({style:1,script:1}),w=e({base:1,link:1,meta:1,title:1}),E=t(w,b),S=e({head:1,body:1}),x=e({html:1}),T=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),N=e({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return e({$nonBodyContent:t(x,S,w),$block:T,$inline:p,$body:t(e({script:1,style:1}),T),$cdata:e({script:1,style:1}),$empty:N,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:S,head:E,style:v,script:v,body:g,base:{},link:{},meta:{},title:v,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:g,td:g,br:{},th:g,center:g,kbd:p,button:t(l,o),basefont:{},h5:p,h4:p,samp:p,h6:p,ol:y,h1:p,h3:p,option:v,h2:p,form:t(n,s,o,l),select:e({optgroup:1,option:1}),font:p,ins:p,menu:y,abbr:p,label:p,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:p,tfoot:d,cite:p,li:g,input:{},iframe:g,strong:p,textarea:v,noframes:g,big:p,small:p,span:e({"#":1,br:1}),hr:p,dt:p,sub:p,optgroup:e({option:1}),param:{},bdo:p,"var":p,div:g,object:m,sup:p,dd:g,strike:p,area:{},dir:y,map:t(e({area:1,form:1,p:1}),n,u,o),applet:m,dl:e({dt:1,dd:1}),del:p,isindex:{},fieldset:t(e({legend:1}),h),thead:d,ul:y,acronym:p,b:p,a:t(e({a:1}),c),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),g),caption:p,i:p,u:p,tbody:d,s:p,address:t(s,l),tt:p,legend:p,q:p,pre:t(a,i),p:t(e({a:1}),p),em:p,dfn:p})}(),attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=="6"?"﻿":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t)return 0;var n,r=[e],i=[t];n=e;while(n=n.parentNode){if(n===t)return 10;r.push(n)}n=t;while(n=n.parentNode){if(n===e)return 20;i.push(n)}r.reverse();i.reverse();if(r[0]!==i[0])return 1;var s=-1;while(s++,r[s]===i[s]);e=r[s];t=i[s];while(e=e.nextSibling)if(e===t)return 4;return 2},getNodeIndex:function(e,t){var n=e,r=0;while(n=n.previousSibling){if(t&&n.nodeType==3){n.nodeType!=n.nextSibling.nodeType&&r++;continue}r++}return r},inDoc:function(e,t){return domUtils.getPosition(e,t)==10},findParent:function(e,t,n){if(e&&!domUtils.isBody(e)){e=n?e:e.parentNode;while(e){if(!t||t(e)||domUtils.isBody(e))return t&&!t(e)&&domUtils.isBody(e)?null:e;e=e.parentNode}}return null},findParentByTagName:function(e,t,n,r){t=utils.listToMap(utils.isArray(t)?t:[t]);return domUtils.findParent(e,function(e){return t[e.tagName]&&(!r||!r(e))},n)},findParents:function(e,t,n,r){var i=t&&(n&&n(e)||!n)?[e]:[];while(e=domUtils.findParent(e,n))i.push(e);return r?i:i.reverse()},insertAfter:function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},remove:function(e,t){var n=e.parentNode,r;if(n){if(t&&e.hasChildNodes())while(r=e.firstChild)n.insertBefore(r,e);n.removeChild(e)}return e},getNextDomNode:function(e,t,n,r){return getDomNode(e,"firstChild","nextSibling",t,n,r)},isBookmarkNode:function(e){return e.nodeType==1&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;var n=[e],r=[t],i=e,s=-1;while(i=i.parentNode){if(i===t)return i;n.push(i)}i=t;while(i=i.parentNode){if(i===e)return i;r.push(i)}n.reverse();r.reverse();while(s++,n[s]===r[s]);return s==0?null:n[s-1]},clearEmptySibling:function(e,t,n){function r(e,t){var n;while(e&&!domUtils.isBookmarkNode(e)&&(domUtils.isEmptyInlineElement(e)||!(new RegExp("[^	\n\r"+domUtils.fillChar+"]")).test(e.nodeValue))){n=e[t];domUtils.remove(e);e=n}}!t&&r(e.nextSibling,"nextSibling");!n&&r(e.previousSibling,"previousSibling")},split:function(e,t){var n=e.ownerDocument;if(browser.ie&&t==e.nodeValue.length){var r=n.createTextNode("");return domUtils.insertAfter(e,r)}var i=e.splitText(t);if(browser.ie8){var s=n.createTextNode("");domUtils.insertAfter(i,s);domUtils.remove(s)}return i},isWhitespace:function(e){return!(new RegExp("[^ 	\n\r"+domUtils.fillChar+"]")).test(e.nodeValue)},getXY:function(e){var t=0,n=0;while(e.offsetParent){n+=e.offsetTop;t+=e.offsetLeft;e=e.offsetParent}return{x:t,y:n}},on:function(e,t,n){var r=utils.isArray(t)?t:[t],i=r.length;if(i)while(i--){t=r[i];if(e.addEventListener)e.addEventListener(t,n,!1);else{n._d||(n._d={els:[]});var s=t+n.toString(),o=utils.indexOf(n._d.els,e);if(!n._d[s]||o==-1){o==-1&&n._d.els.push(e);n._d[s]||(n._d[s]=function(e){return n.call(e.srcElement,e||window.event)});e.attachEvent("on"+t,n._d[s])}}}e=null},un:function(e,t,n){var r=utils.isArray(t)?t:[t],i=r.length;if(i)while(i--){t=r[i];if(e.removeEventListener)e.removeEventListener(t,n,!1);else{var s=t+n.toString();try{e.detachEvent("on"+t,n._d?n._d[s]:n)}catch(o){}if(n._d&&n._d[s]){var u=utils.indexOf(n._d.els,e);u!=-1&&n._d.els.splice(u,1);n._d.els.length==0&&delete n._d[s]}}}},isSameElement:function(e,t){if(e.tagName!=t.tagName)return!1;var n=e.attributes,r=t.attributes;if(!ie&&n.length!=r.length)return!1;var i,s,o=0,u=0;for(var a=0;i=n[a++];){if(i.nodeName=="style"){i.specified&&o++;if(domUtils.isSameStyle(e,t))continue;return!1}if(ie){if(!i.specified)continue;o++;s=r.getNamedItem(i.nodeName)}else s=t.attributes[i.nodeName];if(!s.specified||i.nodeValue!=s.nodeValue)return!1}if(ie){for(a=0;s=r[a++];)s.specified&&u++;if(o!=u)return!1}return!0},isSameStyle:function(e,t){var n=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),r=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){n=e.style;r=t.style;if(n.length!=r.length)return!1;for(var i in n){if(/^(\d+|csstext)$/i.test(i))continue;if(n[i]!=r[i])return!1}return!0}if(!n||!r)return n==r;n=n.split(";");r=r.split(";");if(n.length!=r.length)return!1;for(var s=0,o;o=n[s++];)if(utils.indexOf(r,o)==-1)return!1;return!0},isBlockElm:function(e){return e.nodeType==1&&(dtd.$block[e.tagName]||styleBlock[domUtils.getComputedStyle(e,"display")])&&!dtd.$nonChild[e.tagName]},isBody:function(e){return e&&e.nodeType==1&&e.tagName.toLowerCase()=="body"},breakParent:function(e,t){var n,r=e,i=e,s,o;do{r=r.parentNode;if(s){n=r.cloneNode(!1);n.appendChild(s);s=n;n=r.cloneNode(!1);n.appendChild(o);o=n}else{s=r.cloneNode(!1);o=s.cloneNode(!1)}while(n=i.previousSibling)s.insertBefore(n,s.firstChild);while(n=i.nextSibling)o.appendChild(n);i=r}while(t!==r);n=t.parentNode;n.insertBefore(s,t);n.insertBefore(o,t);n.insertBefore(e,o);domUtils.remove(t);return e},isEmptyInlineElement:function(e){if(e.nodeType!=1||!dtd.$removeEmpty[e.tagName])return 0;e=e.firstChild;while(e){if(domUtils.isBookmarkNode(e))return 0;if(e.nodeType==1&&!domUtils.isEmptyInlineElement(e)||e.nodeType==3&&!domUtils.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(e){function t(t){var n;while((n=e[t])&&n.nodeType==3&&domUtils.isWhitespace(n))e.removeChild(n)}t("firstChild");t("lastChild")},mergeChild:function(e,t,n){var r=domUtils.getElementsByTagName(e,e.tagName.toLowerCase());for(var i=0,s;s=r[i++];){if(!s.parentNode||domUtils.isBookmarkNode(s))continue;if(s.tagName.toLowerCase()=="span"){if(e===s.parentNode){domUtils.trimWhiteTextNode(e);if(e.childNodes.length==1){e.style.cssText=s.style.cssText+";"+e.style.cssText;domUtils.remove(s,!0);continue}}s.style.cssText=e.style.cssText+";"+s.style.cssText;if(n){var o=n.style;if(o){o=o.split(";");for(var u=0,a;a=o[u++];)s.style[utils.cssStyleToDomStyle(a.split(":")[0])]=a.split(":")[1]}}domUtils.isSameStyle(s,e)&&domUtils.remove(s,!0);continue}domUtils.isSameElement(e,s)&&domUtils.remove(s,!0)}},getElementsByTagName:function(e,t,n){if(n&&utils.isString(n)){var r=n;n=function(e){return domUtils.hasClass(e,r)}}t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");var i=[];for(var s=0,o;o=t[s++];){var u=e.getElementsByTagName(o);for(var a=0,f;f=u[a++];)(!n||n(f))&&i.push(f)}return i},mergeToParent:function(e){var t=e.parentNode;while(t&&dtd.$removeEmpty[t.tagName]){if(t.tagName==e.tagName||t.tagName=="A"){domUtils.trimWhiteTextNode(t);if(t.tagName=="SPAN"&&!domUtils.isSameStyle(t,e)||t.tagName=="A"&&e.tagName=="SPAN"){if(t.childNodes.length>1||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText;t=t.parentNode;continue}t.style.cssText+=";"+e.style.cssText;t.tagName=="A"&&(t.style.textDecoration="underline")}if(t.tagName!="A"){t===e.parentNode&&domUtils.remove(e,!0);break}}t=t.parentNode}},mergeSibling:function(e,t,n){function r(e,t,n){var r;if((r=n[e])&&!domUtils.isBookmarkNode(r)&&r.nodeType==1&&domUtils.isSameElement(n,r)){while(r.firstChild)t=="firstChild"?n.insertBefore(r.lastChild,n.firstChild):n.appendChild(r.firstChild);domUtils.remove(r)}}!t&&r("previousSibling","firstChild",e);!n&&r("nextSibling","lastChild",e)},unSelectable:ie||browser.opera?function(e){e.onselectstart=function(){return!1};e.onclick=e.onkeyup=e.onkeydown=function(){return!1};e.unselectable="on";e.setAttribute("unselectable","on");for(var t=0,n;n=e.all[t++];)switch(n.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:n.unselectable="on";e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n=0,r;r=t[n++];){r=attrFix[r]||r;switch(r){case"className":e[r]="";break;case"style":e.style.cssText="";!browser.ie&&e.removeAttributeNode(e.getAttributeNode("style"))}e.removeAttribute(r)}},createElement:function(e,t,n){return domUtils.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];switch(n){case"class":e.className=r;break;case"style":e.style.cssText=e.style.cssText+";"+r;break;case"innerHTML":e[n]=r;break;case"value":e.value=r;break;default:e.setAttribute(attrFix[n]||n,r)}}return e},getComputedStyle:function(e,t){var n="width height top left";if(n.indexOf(t)>-1)return e["offset"+t.replace(/^\w/,function(e){return e.toUpperCase()})]+"px";e.nodeType==3&&(e=e.parentNode);if(browser.ie&&browser.version<9&&t=="font-size"&&!e.style.fontSize&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]){var r=e.ownerDocument.createElement("span");r.style.cssText="padding:0;border:0;font-family:simsun;";r.innerHTML=".";e.appendChild(r);var i=r.offsetHeight;e.removeChild(r);r=null;return i+"px"}try{var s=domUtils.getStyle(e,t)||(window.getComputedStyle?domUtils.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[utils.cssStyleToDomStyle(t)])}catch(o){return""}return utils.transUnitToPx(utils.fixColor(t,s))},removeClasses:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n=0,r,i=e.className;r=t[n++];)i=i.replace(new RegExp("\\b"+r+"\\b"),"");i=utils.trim(i).replace(/[ ]{2,}/g," ");i?e.className=i:domUtils.removeAttributes(e,["class"])},addClass:function(e,t){if(!e)return;t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n=0,r,i=e.className;r=t[n++];)(new RegExp("\\b"+r+"\\b")).test(i)||(e.className+=" "+r)},hasClass:function(e,t){if(utils.isRegExp(t))return t.test(e.className);t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n=0,r,i=e.className;r=t[n++];)if(!(new RegExp("\\b"+r+"\\b","i")).test(i))return!1;return n-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){browser.ie&&browser.version>8?e.style.cssText=e.style.cssText.replace(new RegExp(t+"s*:s*[^;]+;?"),""):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(utils.cssStyleToDomStyle(t));e.style.cssText||domUtils.removeAttributes(e,["style"])},getStyle:function(e,t){var n=e.style[utils.cssStyleToDomStyle(t)];return utils.fixColor(t,n)},setStyle:function(e,t,n){e.style[utils.cssStyleToDomStyle(t)]=n},setStyles:function(e,t){for(var n in t)t.hasOwnProperty(n)&&domUtils.setStyle(e,n,t[n])},removeDirtyAttr:function(e){for(var t=0,n,r=e.getElementsByTagName("*");n=r[t++];)n.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,r=e.firstChild;t=t||function(){return 1};while(r){t(r)&&n++;r=r.nextSibling}return n},isEmptyNode:function(e){return!e.firstChild||domUtils.getChildCount(e,function(e){return!domUtils.isBr(e)&&!domUtils.isBookmarkNode(e)&&!domUtils.isWhitespace(e)})==0},clearSelectedArr:function(e){var t;while(t=e.pop())domUtils.removeAttributes(t,["class"])},scrollToView:function(e,t,n){var r=function(){var e=t.document,n=e.compatMode=="CSS1Compat";return{width:(n?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(n?e.documentElement.clientHeight:e.body.clientHeight)||0}},i=function(e){if("pageXOffset"in e)return{x:e.pageXOffset||0,y:e.pageYOffset||0};var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},s=r().height,o=s*-1+n;o+=e.offsetHeight||0;var u=domUtils.getXY(e);o+=u.y;var a=i(t).y;(o>a||o<a-s)&&t.scrollTo(0,o+(o<0?-20:20))},isBr:function(e){return e.nodeType==1&&e.tagName=="BR"},isFillChar:function(e,t){return e.nodeType==3&&!e.nodeValue.replace(new RegExp((t?"^":"")+domUtils.fillChar),"").length},isStartInblock:function(e){var t=e.cloneRange(),n=0,r=t.startContainer,i;if(r.nodeType==1&&r.childNodes[t.startOffset]){r=r.childNodes[t.startOffset];var s=r.previousSibling;while(s&&domUtils.isFillChar(s)){r=s;s=s.previousSibling}}if(this.isFillChar(r,!0)&&t.startOffset==1){t.setStartBefore(r);r=t.startContainer}while(r&&domUtils.isFillChar(r)){i=r;r=r.previousSibling}if(i){t.setStartBefore(i);r=t.startContainer}r.nodeType==1&&domUtils.isEmptyNode(r)&&t.startOffset==1&&t.setStart(r,0).collapse(!0);while(!t.startOffset){r=t.startContainer;if(domUtils.isBlockElm(r)||domUtils.isBody(r)){n=1;break}var s=t.startContainer.previousSibling,o;if(!s)t.setStartBefore(t.startContainer);else{while(s&&domUtils.isFillChar(s)){o=s;s=s.previousSibling}o?t.setStartBefore(o):t.setStartBefore(t.startContainer)}}return n&&!domUtils.isBody(t.startContainer)?1:0},isEmptyBlock:function(e){var t=new RegExp("[ 	\r\n"+domUtils.fillChar+"]","g");if(e[browser.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var n in dtd.$isNotEmpty)if(e.getElementsByTagName(n).length)return 0;return 1},setViewportOffset:function(e,t){var n=parseInt(e.style.left)|0,r=parseInt(e.style.top)|0,i=e.getBoundingClientRect(),s=t.left-i.left,o=t.top-i.top;s&&(e.style.left=n+s+"px");o&&(e.style.top=r+o+"px")},fillNode:function(e,t){var n=browser.ie?e.createTextNode(domUtils.fillChar):e.createElement("br");t.innerHTML="";t.appendChild(n)},moveChild:function(e,t,n){while(e.firstChild)n&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return browser.ie?/^<\w+\s*?>/.test(e.outerHTML):e.attributes.length==0},isCustomeNode:function(e){return e.nodeType==1&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return e.nodeType==1&&(new RegExp(e.tagName,"i")).test(t)},filterNodeList:function(e,t,n){var r=[];if(!utils.isFunction(t)){var i=t;t=function(e){return utils.indexOf(utils.isArray(i)?i:i.split(" "),e.tagName.toLowerCase())!=-1}}utils.each(e,function(e){t(e)&&r.push(e)});return r.length==0?null:r.length==1||!n?r[0]:r},isInNodeEndBoundary:function(e,t){var n=e.startContainer;if(n.nodeType==3&&e.startOffset!=n.nodeValue.length)return 0;if(n.nodeType==1&&e.startOffset!=n.childNodes.length)return 0;while(n!==t){if(n.nextSibling)return 0;n=n.parentNode}return 1},isBoundaryNode:function(e,t){var n;while(!domUtils.isBody(e)){n=e;e=e.parentNode;if(n!==e[t])return!1}return!0}},fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){function r(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function i(e){return!e.collapsed&&e.startContainer.nodeType==1&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function s(e,t,n,i){if(t.nodeType==1&&(dtd.$empty[t.tagName]||dtd.$nonChild[t.tagName])){n=domUtils.getNodeIndex(t)+(e?0:1);t=t.parentNode}if(e){i.startContainer=t;i.startOffset=n;i.endContainer||i.collapse(!0)}else{i.endContainer=t;i.endOffset=n;i.startContainer||i.collapse(!1)}r(i);return i}function o(e,t){var n=e.startContainer,r=e.endContainer,i=e.startOffset,s=e.endOffset,o=e.document,u=o.createDocumentFragment(),a,f;n.nodeType==1&&(n=n.childNodes[i]||(a=n.appendChild(o.createTextNode(""))));r.nodeType==1&&(r=r.childNodes[s]||(f=r.appendChild(o.createTextNode(""))));if(n===r&&n.nodeType==3){u.appendChild(o.createTextNode(n.substringData(i,s-i)));if(t){n.deleteData(i,s-i);e.collapse(!0)}return u}var l,c,h=u,p=domUtils.findParents(n,!0),d=domUtils.findParents(r,!0);for(var v=0;p[v]==d[v];)v++;for(var m=v,g;g=p[m];m++){l=g.nextSibling;if(g==n){if(!a)if(e.startContainer.nodeType==3){h.appendChild(o.createTextNode(n.nodeValue.slice(i)));t&&n.deleteData(i,n.nodeValue.length-i)}else h.appendChild(t?n:n.cloneNode(!0))}else{c=g.cloneNode(!1);h.appendChild(c)}while(l){if(l===r||l===d[m])break;g=l.nextSibling;h.appendChild(t?l:l.cloneNode(!0));l=g}h=c}h=u;if(!p[v]){h.appendChild(p[v-1].cloneNode(!1));h=h.firstChild}for(var m=v,y;y=d[m];m++){l=y.previousSibling;if(y==r){if(!f&&e.endContainer.nodeType==3){h.appendChild(o.createTextNode(r.substringData(0,s)));t&&r.deleteData(0,s)}}else{c=y.cloneNode(!1);h.appendChild(c)}if(m!=v||!p[v])while(l){if(l===n)break;y=l.previousSibling;h.insertBefore(t?l:l.cloneNode(!0),h.firstChild);l=y}h=c}t&&e.setStartBefore(d[v]?p[v]?d[v]:p[v-1]:d[v-1]).collapse(!0);a&&domUtils.remove(a);f&&domUtils.remove(f);return u}function a(e,t){try{if(n&&domUtils.inDoc(n,e))if(!n.nodeValue.replace(fillCharReg,"").length){var r=n.parentNode;domUtils.remove(n);while(r&&domUtils.isEmptyInlineElement(r)&&(browser.safari?!(domUtils.getPosition(r,t)&domUtils.POSITION_CONTAINS):!r.contains(t))){n=r.parentNode;domUtils.remove(r);r=n}}else n.nodeValue=n.nodeValue.replace(fillCharReg,"")}catch(i){}}function f(e,t){var n;e=e[t];while(e&&domUtils.isFillChar(e)){n=e[t];domUtils.remove(e);e=n}}var e=0,t=domUtils.fillChar,n,u=dom.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null;t.document=e;t.collapsed=!0};u.prototype={cloneContents:function(){return this.collapsed?null:o(this,0)},deleteContents:function(){var e;this.collapsed||o(this,1);if(browser.webkit){e=this.startContainer;if(e.nodeType==3&&!e.nodeValue.length){this.setStartBefore(e).collapse(!0);domUtils.remove(e)}}return this},extractContents
:function(){return this.collapsed?null:o(this,2)},setStart:function(e,t){return s(!0,e,t,this)},setEnd:function(e,t){return s(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return(new u(e.document)).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;if(e){t.endContainer=t.startContainer;t.endOffset=t.startOffset}else{t.startContainer=t.endContainer;t.startOffset=t.endOffset}t.collapsed=!0;return t},shrinkBoundary:function(e){function i(e){return e.nodeType==1&&!domUtils.isBookmarkNode(e)&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]}var t=this,n,r=t.collapsed;while(t.startContainer.nodeType==1&&(n=t.startContainer.childNodes[t.startOffset])&&i(n))t.setStart(n,0);if(r)return t.collapse(!0);if(!e)while(t.endContainer.nodeType==1&&t.endOffset>0&&(n=t.endContainer.childNodes[t.endOffset-1])&&i(n))t.setEnd(n,n.childNodes.length);return t},getCommonAncestor:function(e,t){var n=this,r=n.startContainer,s=n.endContainer;if(r===s){if(e&&i(this)){r=r.childNodes[n.startOffset];if(r.nodeType==1)return r}return t&&r.nodeType==3?r.parentNode:r}return domUtils.getCommonAncestor(r,s)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,r=this.collapsed,i=this.endContainer;if(t.nodeType==3){if(n==0)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var s=domUtils.split(t,n);t===i?this.setEnd(s,this.endOffset-n):t.parentNode===i&&(this.endOffset+=1);this.setStartBefore(s)}if(r)return this.collapse(!0)}if(!e){n=this.endOffset;i=this.endContainer;if(i.nodeType==3)if(n==0)this.setEndBefore(i);else{n<i.nodeValue.length&&domUtils.split(i,n);this.setEndAfter(i)}}return this},txtToElmBoundary:function(){function e(e,t){var n=e[t+"Container"],r=e[t+"Offset"];n.nodeType==3&&(r?r>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}if(!this.collapsed){e(this,"start");e(this,"end")}return this},insertNode:function(e){var t=e,n=1;if(e.nodeType==11){t=e.firstChild;n=e.childNodes.length}this.trimBoundary(!0);var r=this.startContainer,i=this.startOffset,s=r.childNodes[i];s?r.insertBefore(e,s):r.appendChild(e);t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n);return this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(t,n){var r,i=this.document.createElement("span");i.style.cssText="display:none;line-height:0px;";i.appendChild(this.document.createTextNode("‍"));i.id="_baidu_bookmark_start_"+(n?"":e++);if(!this.collapsed){r=i.cloneNode(!0);r.id="_baidu_bookmark_end_"+(n?"":e++)}this.insertNode(i);r&&this.collapse().insertNode(r).setEndBefore(r);this.setStartAfter(i);return{start:t?i.id:i,end:r?t?r.id:r:null,id:t}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;this.setStartBefore(t);domUtils.remove(t);if(n){this.setEndBefore(n);domUtils.remove(n)}else this.collapse(!0);return this},enlarge:function(e,t){var n=domUtils.isBody,r,i,s=this.document.createTextNode("");if(e){i=this.startContainer;if(i.nodeType==1)if(i.childNodes[this.startOffset])r=i=i.childNodes[this.startOffset];else{i.appendChild(s);r=i=s}else r=i;for(;;){if(domUtils.isBlockElm(i)){i=r;while((r=i.previousSibling)&&!domUtils.isBlockElm(r))i=r;this.setStartBefore(i);break}r=i;i=i.parentNode}i=this.endContainer;if(i.nodeType==1){(r=i.childNodes[this.endOffset])?i.insertBefore(s,r):i.appendChild(s);r=i=s}else r=i;for(;;){if(domUtils.isBlockElm(i)){i=r;while((r=i.nextSibling)&&!domUtils.isBlockElm(r))i=r;this.setEndAfter(i);break}r=i;i=i.parentNode}s.parentNode===this.endContainer&&this.endOffset--;domUtils.remove(s)}if(!this.collapsed){while(this.startOffset==0){if(t&&t(this.startContainer))break;if(n(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(t&&t(this.endContainer))break;if(n(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!domUtils.isBody(this.endContainer)&&!this.endOffset)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return e.nodeType==1&&domUtils.isBlockElm(e)}).adjustmentBoundary();var r=this.createBookmark(),i=r.end,s=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br":!domUtils.isWhitespace(e)},o=domUtils.getNextDomNode(r.start,!1,s),u,a,f=this.cloneRange();while(o&&domUtils.getPosition(o,i)&domUtils.POSITION_PRECEDING)if(o.nodeType==3||dtd[e][o.tagName]){f.setStartBefore(o);u=o;while(u&&(u.nodeType==3||dtd[e][u.tagName])&&u!==i){a=u;u=domUtils.getNextDomNode(u,u.nodeType==1,null,function(t){return dtd[e][t.tagName]})}var l=f.setEndAfter(a).extractContents(),c;if(n&&n.length>0){var h,p;p=h=n[0].cloneNode(!1);for(var d=1,v;v=n[d++];){h.appendChild(v.cloneNode(!1));h=h.firstChild}c=h}else c=f.document.createElement(e);t&&domUtils.setAttributes(c,t);c.appendChild(l);f.insertNode(n?p:c);var m;if(e=="span"&&t.style&&/text\-decoration/.test(t.style)&&(m=domUtils.findParentByTagName(c,"a",!0))){domUtils.setAttributes(m,t);domUtils.remove(c,!0);c=m}else{domUtils.mergeSibling(c);domUtils.clearEmptySibling(c)}domUtils.mergeChild(c,t);o=domUtils.getNextDomNode(c,!1,s);domUtils.mergeToParent(c);if(u===i)break}else o=domUtils.getNextDomNode(o,!0,s);return this.moveToBookmark(r)},removeInlineStyle:function(e){if(this.collapsed)return this;e=utils.isArray(e)?e:[e];this.shrinkBoundary().adjustmentBoundary();var t=this.startContainer,n=this.endContainer;for(;;){if(t.nodeType==1){if(utils.indexOf(e,t.tagName.toLowerCase())>-1)break;if(t.tagName.toLowerCase()=="body"){t=null;break}}t=t.parentNode}for(;;){if(n.nodeType==1){if(utils.indexOf(e,n.tagName.toLowerCase())>-1)break;if(n.tagName.toLowerCase()=="body"){n=null;break}}n=n.parentNode}var r=this.createBookmark(),i,s;if(t){s=this.cloneRange().setEndBefore(r.start).setStartBefore(t);i=s.extractContents();s.insertNode(i);domUtils.clearEmptySibling(t,!0);t.parentNode.insertBefore(r.start,t)}if(n){s=this.cloneRange().setStartAfter(r.end).setEndAfter(n);i=s.extractContents();s.insertNode(i);domUtils.clearEmptySibling(n,!1,!0);n.parentNode.insertBefore(r.end,n.nextSibling)}var o=domUtils.getNextDomNode(r.start,!1,function(e){return e.nodeType==1}),u;while(o&&o!==r.end){u=domUtils.getNextDomNode(o,!0,function(e){return e.nodeType==1});utils.indexOf(e,o.tagName.toLowerCase())>-1&&domUtils.remove(o,!0);o=u}return this.moveToBookmark(r)},getClosedNode:function(){var e;if(!this.collapsed){var t=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(i(t)){var n=t.startContainer.childNodes[t.startOffset];n&&n.nodeType==1&&(dtd.$empty[n.tagName]||dtd.$nonChild[n.tagName])&&(e=n)}}return e},select:browser.ie?function(e,r){var i;this.collapsed||this.shrinkBoundary();var s=this.getClosedNode();if(s&&!r){try{i=this.document.body.createControlRange();i.addElement(s);i.select()}catch(o){}return this}var u=this.createBookmark(),l=u.start,c;i=this.document.body.createTextRange();i.moveToElementText(l);i.moveStart("character",1);if(!this.collapsed){var h=this.document.body.createTextRange();c=u.end;h.moveToElementText(c);i.setEndPoint("EndToEnd",h)}else if(!e&&this.startContainer.nodeType!=3){var p=this.document.createTextNode(t),d=this.document.createElement("span");d.appendChild(this.document.createTextNode(t));l.parentNode.insertBefore(d,l);l.parentNode.insertBefore(p,l);a(this.document,p);n=p;f(d,"previousSibling");f(l,"nextSibling");i.moveStart("character",-1);i.collapse(!0)}this.moveToBookmark(u);d&&domUtils.remove(d);try{i.select()}catch(o){}return this}:function(e){function r(e){function t(t,n,r){t.nodeType==3&&t.nodeValue.length<n&&(e[r+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start");t(e.endContainer,e.endOffset,"end")}var i=domUtils.getWindow(this.document),s=i.getSelection(),o;browser.gecko?this.document.body.focus():i.focus();if(s){s.removeAllRanges();if(this.collapsed&&!e){var u=this.startContainer,l=u;u.nodeType==1&&(l=u.childNodes[this.startOffset]);if((u.nodeType!=3||!this.startOffset)&&(l?!l.previousSibling||l.previousSibling.nodeType!=3:!u.lastChild||u.lastChild.nodeType!=3)){o=this.document.createTextNode(t);this.insertNode(o);a(this.document,o);f(o,"previousSibling");f(o,"nextSibling");n=o;this.setStart(o,browser.webkit?1:0).collapse(!0)}}var c=this.document.createRange();if(this.collapsed&&browser.opera&&this.startContainer.nodeType==1){var l=this.startContainer.childNodes[this.startOffset];if(!l){l=this.startContainer.lastChild;l&&domUtils.isBr(l)&&this.setStartBefore(l).collapse(!0)}else{while(l&&domUtils.isBlockElm(l)){if(l.nodeType!=1||!l.childNodes[0])break;l=l.childNodes[0]}l&&this.setStartBefore(l).collapse(!0)}}r(this);c.setStart(this.startContainer,this.startOffset);c.setEnd(this.endContainer,this.endOffset);s.addRange(c)}return this},scrollToView:function(e,t){e=e?window:domUtils.getWindow(this.document);var n=this,r=n.document.createElement("span");r.innerHTML="&nbsp;";n.cloneRange().insertNode(r);domUtils.scrollToView(r,e,t);domUtils.remove(r);return n},inFillChar:function(){var e=this.startContainer;return this.collapsed&&e.nodeType==3&&e.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1==e.nodeValue.length?!0:!1},createAddress:function(e,t){function i(e){var n=e?r.startContainer:r.endContainer,i=domUtils.findParents(n,!0,function(e){return!domUtils.isBody(e)}),s=[];for(var o=0,u;u=i[o++];)s.push(domUtils.getNodeIndex(u,t));var a=0;if(t)if(n.nodeType==3){var f=n;while(f=f.previousSibling){if(f.nodeType!=3)break;a+=f.nodeValue.replace(fillCharReg,"").length}a+=(e?r.startOffset:r.endOffset)-(fillCharReg.test(n.nodeValue)?1:0)}else{n=n.childNodes[e?r.startOffset:r.endOffset];if(n)a=domUtils.getNodeIndex(n,t);else{n=e?r.startContainer:r.endContainer;var l=n.firstChild;while(l){if(domUtils.isFillChar(l)){l=l.nextSibling;continue}a++;if(l.nodeType==3)while(l&&l.nodeType==3)l=l.nextSibling;else l=l.nextSibling}}}else a=e?r.startOffset:r.endOffset;a<0&&(a=0);s.push(a);return s}var n={},r=this;n.startAddress=i(!0);e||(n.endAddress=r.collapsed?[].concat(n.startAddress):i());return n},moveToAddress:function(e,t){function r(e,t){var r=n.document.body,i,s;for(var o=0,u,a=e.length;o<a;o++){u=e[o];i=r;r=r.childNodes[u];if(!r){s=u;break}}t?r?n.setStartBefore(r):n.setStart(i,s):r?n.setEndBefore(r):n.setEnd(i,s)}var n=this;r(e.startAddress,!0);!t&&e.endAddress&&r(e.endAddress);return n},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0}}})();(function(){function e(e,t){var n=domUtils.getNodeIndex;e=e.duplicate();e.collapse(t);var r=e.parentElement();if(!r.hasChildNodes())return{container:r,offset:0};var i=r.children,s,o=e.duplicate(),u=0,a=i.length-1,f=-1,l;while(u<=a){f=Math.floor((u+a)/2);s=i[f];o.moveToElementText(s);var c=o.compareEndPoints("StartToStart",e);if(c>0)a=f-1;else{if(!(c<0))return{container:r,offset:n(s)};u=f+1}}if(f==-1){o.moveToElementText(r);o.setEndPoint("StartToStart",e);l=o.text.replace(/(\r\n|\r)/g,"\n").length;i=r.childNodes;if(!l){s=i[i.length-1];return{container:s,offset:s.nodeValue.length}}var h=i.length;while(l>0)l-=i[--h].nodeValue.length;return{container:i[h],offset:-l}}o.collapse(c>0);o.setEndPoint(c>0?"StartToStart":"EndToStart",e);l=o.text.replace(/(\r\n|\r)/g,"\n").length;if(!l)return dtd.$empty[s.tagName]||dtd.$nonChild[s.tagName]?{container:r,offset:n(s)+(c>0?0:1)}:{container:s,offset:c>0?0:s.childNodes.length};while(l>0)try{var p=s;s=s[c>0?"previousSibling":"nextSibling"];l-=s.nodeValue.length}catch(d){return{container:r,offset:n(p)}}return{container:s,offset:c>0?-l:s.nodeValue.length+l}}function t(t,n){if(t.item)n.selectNode(t.item(0));else{var r=e(t,!0);n.setStart(r.container,r.offset);if(t.compareEndPoints("StartToEnd",t)!=0){r=e(t,!1);n.setEnd(r.container,r.offset)}}return n}function n(e){var t;try{t=e.getNative().createRange()}catch(n){return null}var r=t.item?t.item(0):t.parentElement();return(r.ownerDocument||r)===e.document?t:null}var r=dom.Selection=function(e){var t=this,r;t.document=e;if(ie){r=domUtils.getWindow(e).frameElement;domUtils.on(r,"beforedeactivate",function(){t._bakIERange=t.getIERange()});domUtils.on(r,"activate",function(){try{!n(t)&&t._bakIERange&&t._bakIERange.select()}catch(e){}t._bakIERange=null})}r=e=null};r.prototype={getNative:function(){var e=this.document;try{return e?ie?e.selection:domUtils.getWindow(e).getSelection():null}catch(t){return null}},getIERange:function(){var e=n(this);return!e&&this._bakIERange?this._bakIERange:e},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?domUtils.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return browser.ie&&n(this)||!browser.ie&&this.getNative().rangeCount?!0:!1}catch(e){return!1}},getRange:function(){function n(t){var n=e.document.body.firstChild,r=t.collapsed;while(n&&n.firstChild){t.setStart(n,0);n=n.firstChild}t.startContainer||t.setStart(e.document.body,0);r&&t.collapse(!0)}var e=this;if(e._cachedRange!=null)return this._cachedRange;var r=new baidu.editor.dom.Range(e.document);if(ie){var i=e.getIERange();if(i)try{t(i,r)}catch(s){n(r)}else n(r)}else{var o=e.getNative();if(o&&o.rangeCount){var u=o.getRangeAt(0),a=o.getRangeAt(o.rangeCount-1);r.setStart(u.startContainer,u.startOffset).setEnd(a.endContainer,a.endOffset);r.collapsed&&domUtils.isBody(r.startContainer)&&!r.startOffset&&n(r)}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;n(r)}}return this._bakRange=r},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e=ie?this.getIERange():this.getRange(),t,n,r,i;if(ie){if(!e)return this.document.body.firstChild;if(e.item)return e.item(0);t=e.duplicate();t.text.length>0&&t.moveStart("character",1);t.collapse(1);n=t.parentElement();i=r=e.parentElement();while(r=r.parentNode)if(r==n){n=i;break}}else{e.shrinkBoundary();n=e.startContainer;n.nodeType==1&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,e.startOffset)]);if(n.nodeType==3)return n.parentNode}return n},getText:function(){var e,t;if(this.isFocus()&&(e=this.getNative())){t=browser.ie?e.createRange():e.getRangeAt(0);return browser.ie?t.text:t.toString()}return""},clearRange:function(){this.getNative()[browser.ie?"empty":"removeAllRanges"]()}}})();(function(){function n(e){var t=e.getElementsByTagName("img"),n;for(var r=0,i;i=t[r++];)if(n=i.getAttribute("orgSrc")){i.src=n;i.removeAttribute("orgSrc")}var s=e.getElementsByTagName("a");for(var r=0,o;o=s[r++];r++)o.getAttribute("data_ue_src")&&o.setAttribute("href",o.getAttribute("data_ue_src"))}function r(e,t){var n;if(t.textarea)if(utils.isString(t.textarea)){for(var r=0,i,s=domUtils.getElementsByTagName(e,"textarea");i=s[r++];)if(i.id=="ueditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;if(!n){e.appendChild(n=domUtils.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"}));t.textarea=n}n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}var e=0,t,i=UE.Editor=function(t){var n=this;n.uid=e++;EventBase.call(n);n.commands={};n.options=utils.extend(utils.clone(t||{}),UEDITOR_CONFIG,!0);n.shortcutkeys={};n.setOpt({isShow:!0,initialContent:"欢迎使用ueditor!",autoClearinitialContent:!1,iframeCssUrl:n.options.UEDITOR_HOME_URL+"../css/iframe.css",textarea:"editorValue",focus:!1,initialFrameWidth:1e3,initialFrameHeight:n.options.minFrameHeight||320,minFrameWidth:800,minFrameHeight:220,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",pageBreakTag:"_baidu_page_break_tag_",customDomain:!1,lang:"zh-cn",langPath:n.options.UEDITOR_HOME_URL+"../js/",theme:"default",themePath:n.options.UEDITOR_HOME_URL+"../",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1});utils.loadFile(document,{src:n.options.langPath+n.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){for(var e in UE.plugins)UE.plugins[e].call(n);n.langIsReady=!0;n.fireEvent("langReady")});UE.instants["ueditorInstant"+n.uid]=n};i.prototype={ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};utils.isString(e)?n[e]=t:n=e;utils.extend(this.options,n,!0)},destroy:function(){var e=this;e.fireEvent("destroy");var t=e.container.parentNode,n=e.textarea;if(!n){n=document.createElement("textarea");t.parentNode.insertBefore(n,t)}else n.style.display="";n.style.width=t.offsetWidth+"px";n.style.height=t.offsetHeight+"px";n.value=e.getContent();n.id=e.key;t.innerHTML="";domUtils.remove(t);var r=e.key;for(var i in e)e.hasOwnProperty(i)&&delete this[i];UE.delEditor(r)},render:function(e){var t=this,n=t.options;utils.isString(e)&&(e=document.getElementById(e));if(e){var r=ie&&browser.version<9,i=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml'"+(r?"":" class='view'")+"><head>"+(n.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(n.iframeCssUrl)+"'/>":"")+"<style type='text/css'>"+".view{padding:0;word-wrap:break-word;cursor:text;height:100%;}\n"+"body{margin:8px;font-family:sans-serif;font-size:16px;}"+"p{margin:5px 0;}"+(n.initialStyle||"")+"</style></head><body"+(r?" class='view'":"")+"></body>";if(n.customDomain&&document.domain!=location.hostname){i+="<script>window.parent.UE.instants['ueditorInstant"+t.uid+"']._setup(document);</script></html>";e.appendChild(domUtils.createElement(document,"iframe",{id:"baidu_editor_"+t.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();document.domain="'+document.domain+'";'+'document.write("'+i+'");document.close();}())'}))}else{e.innerHTML='<iframe id="baidu_editor_'+this.uid+'"'+'width="100%" height="100%" scroll="no" frameborder="0" ></iframe>';var s=e.firstChild.contentWindow.document;s.open();s.write(i+"</html>");s.close();t._setup(s)}e.style.overflow="hidden"}},_setup:function(e){var t=this,n=t.options;if(ie){e.body.disabled=!0;e.body.contentEditable=!0;e.body.disabled=!1}else{e.body.contentEditable=!0;e.body.spellcheck=!1}t.document=e;t.window=e.defaultView||e.parentWindow;t.iframe=t.window.frameElement;t.body=e.body;t.setHeight(Math.max(n.minFrameHeight,n.initialFrameHeight));t.selection=new dom.Selection(e);var i;browser.gecko&&(i=this.selection.getNative())&&i.removeAllRanges();this._initEvents();if(n.initialContent)if(n.autoClearinitialContent){var s=t.execCommand;t.execCommand=function(){t.fireEvent("firstBeforeExecCommand");return s.apply(t,arguments)};this._setDefaultContent(n.initialContent)}else this.setContent(n.initialContent,!1,!0);for(var o=this.iframe.parentNode;!domUtils.isBody(o);o=o.parentNode)if(o.tagName=="FORM"){domUtils.on(o,"submit",function(){r(this,t)});break}domUtils.isEmptyNode(t.body)&&(t.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>");n.focus&&setTimeout(function(){t.focus();!t.options.autoClearinitialContent&&t._selectionChange()},0);t.container||(t.container=this.iframe.parentNode);n.fullscreen&&t.ui&&t.ui.setFullScreen(!0);try{t.document.execCommand("2D-position",!1,!1)}catch(u){}try{t.document.execCommand("enableInlineTableEditing",!1,!1)}catch(u){}try{t.document.execCommand("enableObjectResizing",!1,!1)}catch(u){}t._bindshortcutKeys();t.isReady=1;t.fireEvent("ready");n.onready&&n.onready.call(t);browser.ie||domUtils.on(t.window,["blur","focus"],function(e){if(e.type=="blur"){t._bakRange=t.selection.getRange();try{t.selection.getNative().removeAllRanges()}catch(e){}}else try{t._bakRange&&t._bakRange.select()}catch(e){}});if(browser.gecko&&browser.version<=10902){t.body.contentEditable=!1;setTimeout(function(){t.body.contentEditable=!0},100);setInterval(function(){t.body.style.height=t.iframe.offsetHeight-20+"px"},100)}!n.isShow&&t.setHide();n.readonly&&t.setDisabled()},sync:function(e){var t=this,n=e?document.getElementById(e):domUtils.findParent(t.iframe.parentNode,function(e){return e.tagName=="FORM"},!0);n&&r(n,t)},setHeight:function(e){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px");this.document.body.style.height=e-20+"px"},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e;utils.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,r){var i=r.keyCode||r.which;for(var s in t){var o=t[s].split(",");for(var u=0,a;a=o[u++];){a=a.split(":");var f=a[0],l=a[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(f.toLowerCase())||/^(\d+)$/.test(f))if((RegExp.$1=="ctrl"?r.ctrlKey||r.metaKey:0)&&(RegExp.$2!=""?r[RegExp.$2.slice(1)+"Key"]:1)&&i==RegExp.$3||i==RegExp.$1){e.execCommand(s,l);domUtils.preventDefault(r)}}}})},getContent:function(e,t,n){var r=this;if(e&&utils.isFunction(e)){t=e;e=""}if(t?!t():!this.hasContents())return"";var i=r.selection.getRange(),s=i.createAddress();r.fireEvent("beforegetcontent",e);var o=new RegExp(domUtils.fillChar,"g"),u=r.body.innerHTML.replace(o,"").replace(/>[\t\r\n]*?</g,"><");r.fireEvent("aftergetcontent",e);try{i.moveToAddress(s).select(!0)}catch(a){}if(r.serialize){var f=r.serialize.parseHTML(u);f=r.serialize.transformOutput(f);u=r.serialize.toHTML(f)}ie&&n?u=u.replace(/<p>\s*?<\/p>/g,"<p>&nbsp;</p>"):u=u.replace(/(&nbsp;)+/g,function(e){for(var t=0,n=[],r=e.split(";").length-1;t<r;t++)n.push(t%2==0?" ":"&nbsp;");return n.join("")});return u},getAllHtml:function(){var e=this,t=[],n="";e.fireEvent("getAllHtml",t);if(browser.ie&&browser.version>8){var r="";utils.each(e.document.styleSheets,function(e){r+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"});utils.each(e.document.getElementsByTagName("script"),function(e){r+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(r||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head>"+"<body "+(ie&&browser.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(domUtils.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return dtd.$block[n]?"\n":t?t:""});return t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(e,t,r){var i=this,s=utils.extend({a:1,A:1},dtd.$inline,!0),o;e=e.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>(?:(\s|&nbsp;)*?)</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(e,t,n){t?o=n:t=o;return!s[t]&&!s[n]?e.replace(/>[ \t\r\n]*?</,"><"):e});e={html:e};i.fireEvent("beforesetcontent",e);e=e.html;var u=this.serialize;if(u){var a=u.parseHTML(e);a=u.transformInput(a);a=u.filter(a);e=u.toHTML(a)}this.body.innerHTML=(t?this.getContent():"")+e.replace(new RegExp("[\r"+domUtils.fillChar+"]*","g"),"");browser.ie&&browser.version<7&&n(this.document.body);if(i.options.enterTag=="p"){var f=this.body.firstChild,l;if(!f||f.nodeType==1&&(dtd.$cdata[f.tagName]||domUtils.isCustomeNode(f))&&f===this.body.lastChild)this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else{var c=i.document.createElement("p");while(f){while(f&&(f.nodeType==3||f.nodeType==1&&dtd.p[f.tagName]&&!dtd.$cdata[f.tagName])){l=f.nextSibling;c.appendChild(f);f=l}if(c.firstChild){if(!f){i.body.appendChild(c);break}f.parentNode.insertBefore(c,f);c=i.document.createElement("p")}f=f.nextSibling}}}i.fireEvent("aftersetcontent");i.fireEvent("contentchange");!r&&i._selectionChange();i._bakRange=i._bakIERange=null;var h;browser.gecko&&(h=this.selection.getNative())&&h.removeAllRanges()},focus:function(e){try{var t=this,n=t.selection.getRange();e?n.setStartAtLast(t.body.lastChild).setCursor(!1,!0):n.select(!0)}catch(r){}},_initEvents:function(){var e=this,t=e.document,n=e.window;e._proxyDomEvent=utils.bind(e._proxyDomEvent,e);domUtils.on(t,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],e._proxyDomEvent);domUtils.on(n,["focus","blur"],e._proxyDomEvent);domUtils.on(t,["mouseup","keydown"],function(t){if(t.type=="keydown"&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey))return;if(t.button==2)return;e._selectionChange(250,t)});var r=0,i=browser.ie?e.body:e.document,s;domUtils.on(i,"dragstart",function(){r=1});domUtils.on(i,browser.webkit?"dragover":"drop",function(){return browser.webkit?function(){clearTimeout(s);s=setTimeout(function(){if(!r){var t=e.selection,n=t.getRange();if(n){var i=n.getCommonAncestor();if(i&&e.serialize){var s=e.serialize,o=s.filter(s.transformInput(s.parseHTML(s.word(i.innerHTML))));i.innerHTML=s.toHTML(o)}}}r=0},200)}:function(e){r||(e.preventDefault?e.preventDefault():e.returnValue=!1);r=0}}())},_proxyDomEvent:function(e){return this.fireEvent(e.type.replace(/^on/,""),e)},_selectionChange:function(e,n){var r=this,i=!1,s,o;if(browser.ie&&browser.version<9&&n&&n.type=="mouseup"){var u=this.selection.getRange();if(!u.collapsed){i=!0;s=n.clientX;o=n.clientY}}clearTimeout(t);t=setTimeout(function(){if(!r.selection.getNative())return;var e;if(i&&r.selection.getNative().type=="None"){e=r.document.body.createTextRange();try{e.moveToPoint(s,o)}catch(t){e=null}}var u;if(e){u=r.selection.getIERange;r.selection.getIERange=function(){return e}}r.selection.cache();u&&(r.selection.getIERange=u);if(r.selection._cachedRange&&r.selection._cachedStartElement){r.fireEvent("beforeselectionchange");r.fireEvent("selectionchange",!!n);r.fireEvent("afterselectionchange");r.selection.clear()}},e||50)},_callCmdFn:function(e,t){var n=t[0].toLowerCase(),r,i;r=this.commands[n]||UE.commands[n];i=r&&r[e];if((!r||!i)&&e=="queryCommandState")return 0;if(i)return i.apply(this,t)},execCommand:function(e){e=e.toLowerCase();var t=this,n,r=t.commands[e]||UE.commands[e];if(!r||!r.execCommand)return null;if(!r.notNeedUndo&&!t.__hasEnterExecCommand){t.__hasEnterExecCommand=!0;if(t.queryCommandState(e)!=-1){t.fireEvent("beforeexeccommand",e);n=this._callCmdFn("execCommand",arguments);!t._ignoreContentChange&&t.fireEvent("contentchange");t.fireEvent("afterexeccommand",e)}t.__hasEnterExecCommand=!1}else{n=this._callCmdFn("execCommand",arguments);!t._ignoreContentChange&&t.fireEvent("contentchange")}!t._ignoreContentChange&&t._selectionChange();return n},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t=0,n;n=e[t++];)if(this.document.getElementsByTagName(n).length>0)return!0;if(!domUtils.isEmptyBlock(this.body))return!0;e=["div"];for(t=0;n=e[t++];){var r=domUtils.getElementsByTagName(this.document,n);for(var i=0,s;s=r[i++];)if(domUtils.isCustomeNode(s))return!0}return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e=this,t;if(e.body.contentEditable=="false"){e.body.contentEditable=!0;t=e.selection.getRange();try{t.moveToBookmark(e.lastBk);delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}t.select(!0);if(e.bkqueryCommandState){e.queryCommandState=e.bkqueryCommandState;delete e.bkqueryCommandState}e.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(e){var t=this;e=e?utils.isArray(e)?e:[e]:[];if(t.body.contentEditable=="true"){t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0));t.body.contentEditable=!1;t.bkqueryCommandState=t.queryCommandState;t.queryCommandState=function(n){return utils.indexOf(e,n)!=-1?t.bkqueryCommandState.apply(t,arguments):-1};t.fireEvent("selectionchange")}},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;if(t.document.getElementById("initContent")){t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";t.removeListener("firstBeforeExecCommand focus",e);setTimeout(function(){t.focus();t._selectionChange()},0)}}return function(t){var r=this;r.body.innerHTML='<p id="initContent">'+t+"</p>";browser.ie&&browser.version<7&&n(r.body);r.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if(e.container.style.display=="none"){try{t.moveToBookmark(e.lastBk);delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100);e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0));e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n=0,r;r=e[n++];){t=t[r];if(!t)break}return t},getContentLength:function(e,t){var n=this.getContent().length;if(e){t=(t||[]).concat(["hr","img","iframe"]);n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var r=0,i;i=t[r++];)n+=this.document.getElementsByTagName(i).length}return n}};utils.inherits(i,EventBase)})();UE.plugins.keystrokes=function(){var e=this;e.addListener("keydown",function(t,n){var r=n.keyCode||n.which,i=e.selection.getRange();if(!i.collapsed&&!(n.ctrlKey||n.metaKey||n.shiftKey||n.altKey||r==9)){var s=i.startContainer;domUtils.isFillChar(s)&&i.setStartBefore(s);s=i.endContainer;domUtils.isFillChar(s)&&i.setEndAfter(s);i.txtToElmBoundary();if(i.endContainer&&i.endContainer.nodeType==1){s=i.endContainer.childNodes[i.endOffset];s&&domUtils.isBr(s)&&i.setEndAfter(s)}if(i.startOffset==0){s=i.startContainer;if(domUtils.isBoundaryNode(s,"firstChild")){s=i.endContainer;if(i.endOffset==(s.nodeType==3?s.nodeValue.length:s.childNodes.length)&&domUtils.isBoundaryNode(s,"lastChild")){e.fireEvent("saveScene");e.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";i.setStart(e.body.firstChild,0).setCursor(!1,!0);browser.ie&&e._selectionChange();domUtils.preventDefault(n);return}}}}if(r==8){var o,u;if(i.inFillChar()){o=i.startContainer;i.setStartBefore(o).shrinkBoundary(!0).collapse(!0);domUtils.isFillChar(o)?domUtils.remove(o):o.nodeValue=o.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"")}if(o=i.getClosedNode()){e.fireEvent("saveScene");i.setStartBefore(o);domUtils.remove(o);i.setCursor();e.fireEvent("saveScene");domUtils.preventDefault(n);return}if(!browser.ie){o=domUtils.findParentByTagName(i.startContainer,"table",!0);u=domUtils.findParentByTagName(i.endContainer,"table",!0);if(o&&!u||!o&&u||o!==u){n.preventDefault();return}}}if(r==9){var a={ol:1,ul:1,table:1};if(e.fireEvent("tabkeydown")){domUtils.preventDefault(n);return}range=e.selection.getRange();e.fireEvent("saveScene");for(var f=0,l="",c=e.options.tabSize||4,h=e.options.tabNode||"&nbsp;";f<c;f++)l+=h;var p=e.document.createElement("span");p.innerHTML=l+domUtils.fillChar;if(range.collapsed)range.insertNode(p.cloneNode(!0).firstChild).setCursor(!0);else{o=domUtils.findParent(range
.startContainer,v);u=domUtils.findParent(range.endContainer,v);if(o&&u&&o===u){range.deleteContents();range.insertNode(p.cloneNode(!0).firstChild).setCursor(!0)}else{var d=range.createBookmark(),v=function(e){return domUtils.isBlockElm(e)&&!a[e.tagName.toLowerCase()]};range.enlarge(!0);var m=range.createBookmark(),g=domUtils.getNextDomNode(m.start,!1,v);while(g&&!(domUtils.getPosition(g,m.end)&domUtils.POSITION_FOLLOWING)){g.insertBefore(p.cloneNode(!0).firstChild,g.firstChild);g=domUtils.getNextDomNode(g,!1,v)}range.moveToBookmark(m).moveToBookmark(d).select()}}domUtils.preventDefault(n)}if(browser.gecko&&r==46){range=e.selection.getRange();if(range.collapsed){o=range.startContainer;if(domUtils.isEmptyBlock(o)){var y=o.parentNode;while(domUtils.getChildCount(y)==1&&!domUtils.isBody(y)){o=y;y=y.parentNode}o===y.lastChild&&n.preventDefault();return}}}});e.addListener("keyup",function(t,n){var r=n.keyCode||n.which,i;if(r==8){i=e.selection.getRange();if(i.collapsed&&domUtils.isBody(i.startContainer)){var s=domUtils.createElement(e.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});i.insertNode(s).setStart(s,0).setCursor(!1,!0)}browser.chrome&&i.collapsed&&i.startContainer.nodeType==1&&domUtils.isEmptyBlock(i.startContainer)&&i.select(!0)}})};UE.plugins.fiximgclick=function(){var e=this;browser.webkit&&e.addListener("click",function(t,n){if(n.target.tagName=="IMG"){var r=new dom.Range(e.document);r.selectNode(n.target).select()}})};UE.plugins.enterkey=function(){var e,t=this,n=t.options.enterTag;t.addListener("keyup",function(n,r){var i=r.keyCode||r.which;if(i==13){var s=t.selection.getRange(),o=s.startContainer,u;if(!browser.ie){if(/h\d/i.test(e)){if(browser.gecko){var a=domUtils.findParentByTagName(o,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);if(!a){t.document.execCommand("formatBlock",!1,"<p>");u=1}}else if(o.nodeType==1){var f=t.document.createTextNode(""),l;s.insertNode(f);l=domUtils.findParentByTagName(f,"div",!0);if(l){var c=t.document.createElement("p");while(l.firstChild)c.appendChild(l.firstChild);l.parentNode.insertBefore(c,l);domUtils.remove(l);s.setStartBefore(f).setCursor();u=1}domUtils.remove(f)}t.undoManger&&u&&t.undoManger.save()}browser.opera&&s.select()}setTimeout(function(){t.selection.getRange().scrollToView(t.autoHeightEnabled,t.autoHeightEnabled?domUtils.getXY(t.iframe).y:0)},50)}});t.addListener("keydown",function(r,i){var s=i.keyCode||i.which;if(s==13){t.undoManger&&t.undoManger.save();e="";var o=t.selection.getRange();if(!o.collapsed){var u=o.startContainer,a=o.endContainer,f=domUtils.findParentByTagName(u,"td",!0),l=domUtils.findParentByTagName(a,"td",!0);if(f&&l&&f!==l||!f&&l||f&&!l){i.preventDefault?i.preventDefault():i.returnValue=!1;return}}if(n=="p"){if(!browser.ie){u=domUtils.findParentByTagName(o.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0);if(!u&&!browser.opera){t.document.execCommand("formatBlock",!1,"<p>");if(browser.gecko){o=t.selection.getRange();u=domUtils.findParentByTagName(o.startContainer,"p",!0);u&&domUtils.removeDirtyAttr(u)}}else{e=u.tagName;u.tagName.toLowerCase()=="p"&&browser.gecko&&domUtils.removeDirtyAttr(u)}}}else{i.preventDefault?i.preventDefault():i.returnValue=!1;if(!o.collapsed){o.deleteContents();u=o.startContainer;if(u.nodeType==1&&(u=u.childNodes[o.startOffset])){while(u.nodeType==1){if(dtd.$empty[u.tagName]){o.setStartBefore(u).setCursor();t.undoManger&&t.undoManger.save();return!1}if(!u.firstChild){var c=o.document.createElement("br");u.appendChild(c);o.setStart(u,0).setCursor();t.undoManger&&t.undoManger.save();return!1}u=u.firstChild}if(u===o.startContainer.childNodes[o.startOffset]){c=o.document.createElement("br");o.insertNode(c).setCursor()}else o.setStart(u,0).setCursor()}else{c=o.document.createElement("br");o.insertNode(c).setStartAfter(c).setCursor()}}else{c=o.document.createElement("br");o.insertNode(c);var h=c.parentNode;if(h.lastChild===c){c.parentNode.insertBefore(c.cloneNode(!0),c);o.setStartBefore(c)}else o.setStartAfter(c);o.setCursor()}}}})};UE.plugins.contextmenu=function(){var e=this,t=e.getLang("contextMenu"),n,r=e.options.contextMenu||[{label:t.selectall,cmdName:"selectall"},{label:t.deletecode,cmdName:"highlightcode",icon:"deletehighlightcode"},{label:t.cleardoc,cmdName:"cleardoc",exec:function(){confirm(t.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:t.unlink,cmdName:"unlink"},"-",{group:t.paragraph,icon:"justifyjustify",subMenu:[{label:t.justifyleft,cmdName:"justify",value:"left"},{label:t.justifyright,cmdName:"justify",value:"right"},{label:t.justifycenter,cmdName:"justify",value:"center"},{label:t.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:t.table,icon:"table",subMenu:[{label:t.inserttable,cmdName:"inserttable"},{label:t.deletetable,cmdName:"deletetable"},"-",{label:t.deleterow,cmdName:"deleterow"},{label:t.deletecol,cmdName:"deletecol"},{label:t.insertcol,cmdName:"insertcol"},{label:t.insertcolnext,cmdName:"insertcolnext"},{label:t.insertrow,cmdName:"insertrow"},{label:t.insertrownext,cmdName:"insertrownext"},"-",{label:t.insertcaption,cmdName:"insertcaption"},{label:t.deletecaption,cmdName:"deletecaption"},{label:t.inserttitle,cmdName:"inserttitle"},{label:t.deletetitle,cmdName:"deletetitle"},"-",{label:t.mergecells,cmdName:"mergecells"},{label:t.mergeright,cmdName:"mergeright"},{label:t.mergedown,cmdName:"mergedown"},"-",{label:t.splittorows,cmdName:"splittorows"},{label:t.splittocols,cmdName:"splittocols"},{label:t.splittocells,cmdName:"splittocells"},"-",{label:t.averageDiseRow,cmdName:"averagedistributerow"},{label:t.averageDisCol,cmdName:"averagedistributecol"},"-",{label:t.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this);this.getDialog("edittd").open()}},{label:t.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this);this.getDialog("edittable").open()}}]},{group:t.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:t.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",label:t.tableleft,value:["float","left"]},{cmdName:"tablealignment",label:t.tablecenter,value:["margin","0 auto"]},{cmdName:"tablealignment",label:t.tableright,value:["float","right"]}]},"-",{label:t.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:t.insertparagraphafter,cmdName:"insertparagraph"},{label:t.copy,cmdName:"copy",exec:function(){alert(t.copymsg)},query:function(){return 0}},{label:t.paste,cmdName:"paste",exec:function(){alert(t.pastemsg)},query:function(){return 0}},{label:t.highlightcode,cmdName:"highlightcode",exec:function(){UE.ui.highlightcode&&new UE.ui.highlightcode(this);this.ui._dialogs.highlightcodeDialog.open()}}];if(!r.length)return;var i=UE.ui.uiUtils;e.addListener("contextmenu",function(t,s){var o=i.getViewportOffsetByEvent(s);e.fireEvent("beforeselectionchange");n&&n.destroy();for(var u=0,a,f=[];a=r[u];u++){var l;(function(t){if(t=="-")(l=f[f.length-1])&&l!=="-"&&f.push("-");else if(t.hasOwnProperty("group")){for(var n=0,r,i=[];r=t.subMenu[n];n++)(function(t){t=="-"?(l=i[i.length-1])&&l!=="-"?i.push("-"):i.splice(i.length-1):(e.commands[t.cmdName]||UE.commands[t.cmdName]||t.query)&&(t.query?t.query():e.queryCommandState(t.cmdName))>-1&&i.push({label:t.label||e.getLang("contextMenu."+t.cmdName+(t.value||""))||"",className:"edui-for-"+t.cmdName,onclick:t.exec?function(){t.exec.call(e)}:function(){e.execCommand(t.cmdName,t.value)}})})(r);if(i.length){function s(){switch(t.icon){case"table":return e.getLang("contextMenu.table");case"justifyjustify":return e.getLang("contextMenu.paragraph");case"aligntd":return e.getLang("contextMenu.aligntd");case"aligntable":return e.getLang("contextMenu.aligntable");default:return""}}f.push({label:s(),className:"edui-for-"+t.icon,subMenu:{items:i,editor:e}})}}else if((e.commands[t.cmdName]||UE.commands[t.cmdName]||t.query)&&(t.query?t.query.call(e):e.queryCommandState(t.cmdName))>-1){if(t.cmdName=="highlightcode"){if(e.queryCommandState(t.cmdName)==1&&t.icon!="deletehighlightcode")return;if(e.queryCommandState(t.cmdName)!=1&&t.icon=="deletehighlightcode")return}f.push({label:t.label||e.getLang("contextMenu."+t.cmdName),className:"edui-for-"+(t.icon?t.icon:t.cmdName+(t.value||"")),onclick:t.exec?function(){t.exec.call(e)}:function(){e.execCommand(t.cmdName,t.value)}})}})(a)}f[f.length-1]=="-"&&f.pop();n=new UE.ui.Menu({items:f,editor:e});n.render();n.showAt(o);domUtils.preventDefault(s);if(browser.ie){var c;try{c=e.selection.getNative().createRange()}catch(h){return}if(c.item){var p=new dom.Range(e.document);p.selectNode(c.item(0)).select(!0,!0)}}})};(function(){function e(e){var t=this.document;if(t.getElementById("baidu_pastebin"))return;var n=this.selection.getRange(),r=n.createBookmark(),i=t.createElement("div");i.id="baidu_pastebin";browser.webkit&&i.appendChild(t.createTextNode(domUtils.fillChar+domUtils.fillChar));t.body.appendChild(i);r.start.style.display="";i.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(r.start).y+"px";n.selectNodeContents(i).select(!0);setTimeout(function(){if(browser.webkit)for(var s=0,o=t.querySelectorAll("#baidu_pastebin"),u;u=o[s++];){if(!domUtils.isEmptyNode(u)){i=u;break}domUtils.remove(u)}try{i.parentNode.removeChild(i)}catch(a){}n.moveToBookmark(r).select(!0);e(i)},0)}UE.plugins.paste=function(){function a(e){var a;if(e.firstChild){var f=domUtils.getElementsByTagName(e,"span");for(var l=0,c;c=f[l++];)(c.id=="_baidu_cut_start"||c.id=="_baidu_cut_end")&&domUtils.remove(c);if(browser.webkit){var h=e.querySelectorAll("div br");for(var l=0,p;p=h[l++];){var d=p.parentNode;if(d.tagName=="DIV"&&d.childNodes.length==1){d.innerHTML="<p><br/></p>";w;domUtils.remove(d)}}var v=e.querySelectorAll("#baidu_pastebin");for(var l=0,m;m=v[l++];){var g=t.document.createElement("p");m.parentNode.insertBefore(g,m);while(m.firstChild)g.appendChild(m.firstChild);domUtils.remove(m)}var y=e.querySelectorAll("meta");for(var l=0,b;b=y[l++];)domUtils.remove(b);var h=e.querySelectorAll("br");for(l=0;b=h[l++];)/^apple-/.test(b)&&domUtils.remove(b);utils.each(domUtils.getElementsByTagName(e,"span",function(e){if(e.style.cssText){e.style.cssText=e.style.cssText.replace(/white-space[^;]+;/g,"");if(!e.style.cssText){domUtils.removeAttributes(e,"style");if(domUtils.hasNoAttributes(e))return 1}}return 0}),function(e){domUtils.remove(e,!0)})}if(browser.gecko){var E=e.querySelectorAll("[_moz_dirty]");for(l=0;b=E[l++];)b.removeAttribute("_moz_dirty")}if(!browser.ie){var S=e.querySelectorAll("span.Apple-style-span");for(var l=0,b;b=S[l++];)domUtils.remove(b,!0)}a=e.innerHTML.replace(/>(?:(\s|&nbsp;)*?)</g,"><");var x=t.serialize;if(x)try{a=UE.filterWord(a);var T=x.transformInput(x.parseHTML(a),n);T=x.filter(T,r?{whiteList:{p:{br:1,BR:1,$:{}},br:{$:{}},div:{br:1,BR:1,$:{}},li:{$:{}},tr:{td:1,$:{}},td:{$:{}}},blackList:{style:1,script:1,object:1}}:null,r?null:i);if(browser.webkit){var N=T.children.length,C;while((C=T.children[N-1])&&C.tag=="br"){T.children.splice(N-1,1);N=T.children.length}}a=x.toHTML(T,r);s=x.filter(T,{whiteList:{p:{br:1,BR:1,$:{}},br:{$:{}},div:{br:1,BR:1,$:{},table:1,ul:1,ol:1},li:{$:{}},ul:{li:1,$:{}},ol:{li:1,$:{}},tr:{td:1,$:{}},td:{$:{}},table:{tr:1,tbody:1,td:1,$:{}},tbody:{tr:1,td:1,$:{}},h1:{$:{}},h2:{$:{}},h3:{$:{}},h4:{$:{}},h5:{$:{}},h6:{$:{}}},blackList:{style:1,script:1,object:1}});s=x.toHTML(s,!0)}catch(k){}a={html:a,txtContent:s};t.fireEvent("beforepaste",a);if(a.html){o=a.html;u=t.selection.getRange().createAddress(!0);t.execCommand("insertHtml",o,!0);t.fireEvent("afterpaste")}}}var t=this,n={flag:""},r=t.options.pasteplain===!0,i={flag:""};t.commands.pasteplain={queryCommandState:function(){return r},execCommand:function(){r=!r|0},notNeedUndo:1};var s,o,u;t.addListener("pasteTransfer",function(e,n){if(u&&s&&o&&s!=o){var r=t.selection.getRange();r.moveToAddress(u,!0).deleteContents();r.select(!0);t.__hasEnterExecCommand=!0;var i=o;n===2?i=i.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,n,r){n=n.toLowerCase();if({img:1}[n])return e;r=r.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,n){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+n+" ":""});return{span:1,div:1}[n]?"":"<"+t+n+" "+utils.trim(r)+">"}):n&&(i=s);t.execCommand("inserthtml",i,!0);t.__hasEnterExecCommand=!1;var a=t.selection.getRange().createAddress(!0);u.endAddress=a.startAddress}});t.addListener("ready",function(){domUtils.on(t.body,"cut",function(){var e=t.selection.getRange();!e.collapsed&&t.undoManger&&t.undoManger.save()});domUtils.on(t.body,browser.ie||browser.opera?"keydown":"paste",function(n){if((browser.ie||browser.opera)&&(!n.ctrlKey&&!n.metaKey||n.keyCode!="86"))return;e.call(t,function(e){a(e)})})})}})();var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){function u(){var e=document.getElementById("edui_fixedlayer");o.setViewportOffset(e,{left:0,top:0})}function a(e){t.on(window,"scroll",u);t.on(window,"resize",baidu.editor.utils.defer(u,0,!0))}var e=baidu.editor.browser,t=baidu.editor.dom.domUtils,n="$EDITORUI",r=window[n]={},i="ID"+n,s=0,o=baidu.editor.ui.uiUtils={uid:function(e){return e?e[i]||(e[i]=++s):++s},hook:function(e,t){var n;if(e&&e._callbacks)n=e;else{n=function(){var t;e&&(t=e.apply(this,arguments));var r=n._callbacks,i=r.length;while(i--){var s=r[i].apply(this,arguments);t===undefined&&(t=s)}return t};n._callbacks=[]}n._callbacks.push(t);return n},createElementByHtml:function(e){var t=document.createElement("div");t.innerHTML=e;t=t.firstChild;t.parentNode.removeChild(t);return t},getViewportElement:function(){return e.ie&&e.quirks?document.body:document.documentElement},getClientRect:function(e){var n;try{n=e.getBoundingClientRect()}catch(r){n={left:0,top:0,height:0,width:0}}var i={left:Math.round(n.left),top:Math.round(n.top),height:Math.round(n.bottom-n.top),width:Math.round(n.right-n.left)},s;while((s=e.ownerDocument)!==document&&(e=t.getWindow(s).frameElement)){n=e.getBoundingClientRect();i.left+=n.left;i.top+=n.top}i.bottom=i.top+i.height;i.right=i.left+i.width;return i},getViewportRect:function(){var e=o.getViewportElement(),t=(window.innerWidth||e.clientWidth)|0,n=(window.innerHeight||e.clientHeight)|0;return{left:0,top:0,height:n,width:t,bottom:n,right:t}},setViewportOffset:function(e,n){var r,i=o.getFixedLayer();if(e.parentNode===i){e.style.left=n.left+"px";e.style.top=n.top+"px"}else t.setViewportOffset(e,n)},getEventOffset:function(e){var t=e.target||e.srcElement,n=o.getClientRect(t),r=o.getViewportOffsetByEvent(e);return{left:r.left-n.left,top:r.top-n.top}},getViewportOffsetByEvent:function(e){var n=e.target||e.srcElement,r=t.getWindow(n).frameElement,i={left:e.clientX,top:e.clientY};if(r&&n.ownerDocument!==document){var s=o.getClientRect(r);i.left+=s.left;i.top+=s.top}return i},setGlobal:function(e,t){r[e]=t;return n+'["'+e+'"]'},unsetGlobal:function(e){delete r[e]},copyAttributes:function(n,r){var i=r.attributes,s=i.length;while(s--){var o=i[s];o.nodeName!="style"&&o.nodeName!="class"&&(!e.ie||o.specified)&&n.setAttribute(o.nodeName,o.nodeValue)}r.className&&t.addClass(n,r.className);r.style.cssText&&(n.style.cssText+=";"+r.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&(e===t?!1:e.contains?e.contains(t):e.compareDocumentPosition(t)&16)},startDrag:function(e,t,n){function s(e){var n=e.clientX-r,s=e.clientY-i;t.ondragmove(n,s);e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}var n=n||document,r=e.clientX,i=e.clientY;if(n.addEventListener){function o(e){n.removeEventListener("mousemove",s,!0);n.removeEventListener("mouseup",s,!0);window.removeEventListener("mouseup",o,!0);t.ondragstop()}n.addEventListener("mousemove",s,!0);n.addEventListener("mouseup",o,!0);window.addEventListener("mouseup",o,!0);e.preventDefault()}else{var u=e.srcElement;u.setCapture();function a(){u.releaseCapture();u.detachEvent("onmousemove",s);u.detachEvent("onmouseup",a);u.detachEvent("onlosecaptrue",a);t.ondragstop()}u.attachEvent("onmousemove",s);u.attachEvent("onmouseup",a);u.attachEvent("onlosecaptrue",a);e.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var t=document.getElementById("edui_fixedlayer");if(t==null){t=document.createElement("div");t.id="edui_fixedlayer";document.body.appendChild(t);if(e.ie&&e.version<=8){t.style.position="absolute";a();setTimeout(u)}else t.style.position="fixed";t.style.left="0";t.style.top="0";t.style.width="0";t.style.height="0"}return t},makeUnselectable:function(t){if(e.opera||e.ie&&e.version<9){t.unselectable="on";if(t.hasChildNodes())for(var n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType==1&&o.makeUnselectable(t.childNodes[n])}else t.style.MozUserSelect!==undefined?t.style.MozUserSelect="none":t.style.WebkitUserSelect!==undefined?t.style.WebkitUserSelect="none":t.style.KhtmlUserSelect!==undefined&&(t.style.KhtmlUserSelect="none")}}})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.EventBase,r=baidu.editor.ui.UIBase=function(){};r.prototype={className:"",uiName:"",initOptions:function(e){var n=this;for(var r in e)n[r]=e[r];this.id=this.id||"edui"+t.uid()},initUIBase:function(){this._globalKey=e.unhtml(t.setGlobal(this.id,this))},render:function(e){var n=this.renderHtml(),r=t.createElementByHtml(n),i=domUtils.getElementsByTagName(r,"*"),s="edui-"+(this.theme||this.editor.options.theme),o=document.getElementById("edui_fixedlayer");for(var u=0,a;a=i[u++];)domUtils.addClass(a,s);domUtils.addClass(r,s);if(o){o.className="";domUtils.addClass(o,s)}var f=this.getDom();if(f!=null){f.parentNode.replaceChild(r,f);t.copyAttributes(r,f)}else{typeof e=="string"&&(e=document.getElementById(e));e=e||t.getFixedLayer();domUtils.addClass(e,s);e.appendChild(r)}this.postRender()},getDom:function(e){return e?document.getElementById(this.id+"_"+e):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();e&&baidu.editor.dom.domUtils.remove(e);t.unsetGlobal(this.id)}};e.inherits(r,n)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Separator=function(e){this.initOptions(e);this.initSeparator()};n.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};e.inherits(n,t)})();(function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.UIBase,r=baidu.editor.ui.uiUtils,i=baidu.editor.ui.Mask=function(e){this.initOptions(e);this.initUIBase()};i.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;t.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e._fill()})})},show:function(e){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return!1},_fill:function(){var e=this.getDom(),t=r.getViewportRect();e.style.width=t.width+"px";e.style.height=t.height+"px"}};e.inherits(i,n)})();(function(){function o(e,t){var n=[];for(var r=0;r<s.length;r++){var i=s[r];if(!i.isHidden()&&i.queryAutoHide(t)!==!1){if(e&&/scroll/ig.test(e.type)&&i.className=="edui-wordpastepop")return;i.hide()}}}var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.dom.domUtils,r=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup=function(e){this.initOptions(e);this.initPopup()},s=[];i.postHide=o;var u=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];i.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase();s.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div>"+" </div>"+"</div>"},getContentHtmlTpl:function(){return this.content?typeof this.content=="string"?this.content:this.content.renderHtml():""},_UIBase_postRender:r.prototype.postRender,postRender:function(){this.content instanceof r&&this.content.postRender();this.fireEvent("postRenderAfter");this.hide(!0);this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var e=this.getDom("content");return t.getClientRect(e)},fitSize:function(){var e=this.getDom("body");e.style.width="";e.style.height="";var t=this.mesureSize();e.style.width=t.width+"px";e.style.height=t.height+"px";return t},showAnchor:function(e,n){this.showAnchorRect(t.getClientRect(e),n)},showAnchorRect:function(e,r,i){this._doAutoRender();var s=t.getViewportRect();this._show();var o=this.fitSize(),a,f,l,c;if(r){a=this.canSideLeft&&e.right+o.width>s.right&&e.left>o.width;f=this.canSideUp&&e.top+o.height>s.bottom&&e.bottom>o.height;l=a?e.left-o.width:e.right;c=f?e.bottom-o.height:e.top}else{a=this.canSideLeft&&e.right+o.width>s.right&&e.left>o.width;f=this.canSideUp&&e.top+o.height>s.bottom&&e.bottom>o.height;l=a?e.right-o.width:e.left;c=f?e.top-o.height:e.bottom}var h=this.getDom();t.setViewportOffset(h,{left:l,top:c});n.removeClasses(h,u);h.className+=" "+u[(f?1:0)*2+(a?1:0)];if(this.editor){h.style.zIndex=this.editor.container.style.zIndex*1+10;baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=h.style.zIndex-1}},showAt:function(e){var t=e.left,n=e.top,r={left:t,top:n,right:t,bottom:n,height:0,width:0};this.showAnchorRect(r,!1,!0)},_show:function(){if(this._hidden){var e=this.getDom();e.style.display="";this._hidden=!1;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(e){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=!0;e||this.fireEvent("hide")}},queryAutoHide:function(e){return!e||!t.contains(this.getDom(),e)}};e.inherits(i,r);n.on(document,"mousedown",function(e){var t=e.target||e.srcElement;o(e,t)});n.on(window,"scroll",function(e,t){o(e,t)})})();(function(){function i(e,t){var n='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+e+"</div>"+"</div>"+'<table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0">'+'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+t.getLang("themeColor")+"</td> </tr>"+'<tr class="edui-colorpicker-tablefirstrow" >';for(var i=0;i<r.length;i++){i&&i%10===0&&(n+="</tr>"+(i==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+t.getLang("standardColor")+"</td></tr>":"")+"<tr"+(i==60?' class="edui-colorpicker-tablefirstrow"':"")+">");n+=i<70?'<td style="padding: 0 2px;"><a hidefocus title="'+r[i]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell"'+' data-color="#'+r[i]+'"'+' style="background-color:#'+r[i]+";border:solid #ccc;"+(i<10||i>=60?"border-width:1px;":i>=10&&i<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"'+"></a></td>":""}n+="</tr></table></div>";return n}var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.ColorPicker=function(e){this.initOptions(e);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()};n.prototype={getHtmlTpl:function(){return i(this.noColorText,this.editor)},_onTableClick:function(e){var t=e.target||e.srcElement,n=t.getAttribute("data-color");n&&this.fireEvent("pickcolor",n)},_onTableOver:function(e){var t=e.target||e.srcElement,n=t.getAttribute("data-color");n&&(this.getDom("preview").style.backgroundColor=n)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};e.inherits(n,t);var r="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,r=baidu.editor.ui.TablePicker=function(e){this.initOptions(e);this.initTablePicker()};r.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:n.prototype.render,render:function(e){this._UIBase_render(e);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(e,t){var n=this.getDom("overlay").style,r=this.lengthOfCellSide;n.width=e*r+"px";n.height=t*r+"px";var i=this.getDom("label");i.innerHTML=e+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row");this.numCols=e;this.numRows=t},_onMouseOver:function(e,n){var r=e.relatedTarget||e.fromElement;if(!t.contains(n,r)&&n!==r){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility=""}},_onMouseOut:function(e,n){var r=e.relatedTarget||e.toElement;if(!t.contains(n,r)&&n!==r){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(e,n){var r=this.getDom("overlay").style,i=t.getEventOffset(e),s=this.lengthOfCellSide,o=Math.ceil(i.left/s),u=Math.ceil(i.top/s);this._track(o,u)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}};e.inherits(r,n)})();(function(){var e=baidu.editor.browser,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,r='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(e.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return r})},Stateful_onMouseEnter:function(e,t){this.target=t;if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,t){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(e,t){var r=e.relatedTarget;!n.contains(t,r)&&t!==r&&this.Stateful_onMouseEnter(e,t)},Stateful_onMouseOut:function(e,t){var r=e.relatedTarget;!n.contains(t,r)&&t!==r&&this.Stateful_onMouseLeave(e,t)},Stateful_onMouseDown:function(e,t){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(e,t){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(e){return t.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.hasState(e)||(this.getStateDom().className+=" edui-state-"+e)},removeState:function(e){this.hasState(e)&&t.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){!this.isDisabled()&&e?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else this.removeState("disabled")}}})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Stateful,r=baidu.editor.ui.Button=function(e){this.initOptions(e);this.initButton()};r.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div>"+"</div>"+"</div></div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onClick:function(){this.isDisabled()||this.fireEvent("click")}};e.inherits(r,t);e.extend(r.prototype,n)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.dom.domUtils,r=baidu.editor.ui.UIBase,i=baidu.editor.ui.Stateful,s=baidu.editor.ui.SplitButton=function(e){this.initOptions(e);this.initSplitButton()};s.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var e=this;if(this.popup!=null){var t=this.popup;this.popup=null;this.setPopup(t)}},_UIBase_postRender:r.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(n){if(this.popup===n)return;this.popup!=null&&this.popup.dispose();n.addListener("show",e.bind(this._onPopupShow,this));n.addListener("hide",e.bind(this._onPopupHide,this));n.addListener("postrender",e.bind(function(){n.getDom("body").appendChild(t.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(t.getClientRect(this.getDom()).width-2)+'px"></div>'));n.getDom().className+=" "+this.className},this));this.popup=n},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body">'+'<div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);">'+'<div class="edui-box edui-icon"></div>'+"</div>"+'<div class="edui-box edui-splitborder"></div>'+'<div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div>'+"</div></div></div>"},showPopup:function(){var e=t.getClientRect(this.getDom());e.top-=
this.popup.SHADOW_RADIUS;e.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(e)},_onArrowClick:function(e,t){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}};e.inherits(s,r);e.extend(s.prototype,i,!0)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.ColorPicker,r=baidu.editor.ui.Popup,i=baidu.editor.ui.SplitButton,s=baidu.editor.ui.ColorButton=function(e){this.initOptions(e);this.initColorButton()};s.prototype={initColorButton:function(){var e=this;this.popup=new r({content:new n({noColorText:e.editor.getLang("clearColor"),editor:e.editor,onpickcolor:function(t,n){e._onPickColor(n)},onpicknocolor:function(t,n){e._onPickNoColor(n)}}),editor:e.editor});this.initSplitButton()},_SplitButton_postRender:i.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(t.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(e){this.getDom("colorlump").style.backgroundColor=e;this.color=e},_onPickColor:function(e){if(this.fireEvent("pickcolor",e)!==!1){this.setColor(e);this.popup.hide()}},_onPickNoColor:function(e){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}};e.inherits(s,i)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,n=baidu.editor.ui.TablePicker,r=baidu.editor.ui.SplitButton,i=baidu.editor.ui.TableButton=function(e){this.initOptions(e);this.initTableButton()};i.prototype={initTableButton:function(){var e=this;this.popup=new t({content:new n({editor:e.editor,onpicktable:function(t,n,r){e._onPickTable(n,r)}}),editor:e.editor});this.initSplitButton()},_onPickTable:function(e,t){this.fireEvent("picktable",e,t)!==!1&&this.popup.hide()}};e.inherits(i,r)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.AutoTypeSetPicker=function(e){this.initOptions(e);this.initAutoTypeSetPicker()};n.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,t=e.options.autotypeset,n=e.getLang("autoTypeSet");return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap colspan="2"><input type="checkbox" name="mergeEmptyline" '+(t.mergeEmptyline?"checked":"")+">"+n.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(t.removeEmptyline?"checked":"")+">"+n.delLine+"</td></tr>"+'<tr><td nowrap colspan="2"><input type="checkbox" name="removeClass" '+(t.removeClass?"checked":"")+">"+n.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(t.indent?"checked":"")+">"+n.indent+"</td></tr>"+'<tr><td nowrap colspan="2"><input type="checkbox" name="textAlign" '+(t.textAlign?"checked":"")+">"+n.alignment+'</td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+(t.textAlign&&t["textAlign"]=="left"?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="textAlignValue" value="center" '+(t.textAlign&&t["textAlign"]=="center"?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="textAlignValue" value="right" '+(t.textAlign&&t["textAlign"]=="right"?"checked":"")+">"+e.getLang("justifyright")+" </tr>"+'<tr><td nowrap colspan="2"><input type="checkbox" name="imageBlockLine" '+(t.imageBlockLine?"checked":"")+">"+n.imageFloat+"</td>"+'<td nowrap colspan="2" id="imageBlockLineValue">'+'<input type="radio" name="imageBlockLineValue" value="none" '+(t.imageBlockLine&&t["imageBlockLine"]=="none"?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="imageBlockLineValue" value="left" '+(t.imageBlockLine&&t["imageBlockLine"]=="left"?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="imageBlockLineValue" value="center" '+(t.imageBlockLine&&t["imageBlockLine"]=="center"?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="imageBlockLineValue" value="right" '+(t.imageBlockLine&&t["imageBlockLine"]=="right"?"checked":"")+">"+e.getLang("justifyright")+"</tr>"+'<tr><td nowrap colspan="2"><input type="checkbox" name="clearFontSize" '+(t.clearFontSize?"checked":"")+">"+n.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(t.clearFontFamily?"checked":"")+">"+n.removeFontFamily+"</td></tr>"+'<tr><td nowrap colspan="4"><input type="checkbox" name="removeEmptyNode" '+(t.removeEmptyNode?"checked":"")+">"+n.removeHtml+"</td></tr>"+'<tr><td nowrap colspan="4"><input type="checkbox" name="pasteFilter" '+(t.pasteFilter?"checked":"")+">"+n.pasteFilter+"</td></tr>"+'<tr><td nowrap colspan="4" align="right"><button >'+n.run+"</button></td></tr>"+"</table>"+"</div>"+"</div>"},_UIBase_render:t.prototype.render};e.inherits(n,t)})();(function(){function s(e){var t=e.editor.options.autotypeset,n=e.getDom(),r=domUtils.getElementsByTagName(n,"input");for(var i=r.length-1,s;s=r[i--];)if(s.getAttribute("type")=="checkbox"){var o=s.getAttribute("name");t[o]&&delete t[o];if(s.checked){var u=document.getElementById(o+"Value");if(u)if(/input/ig.test(u.tagName))t[o]=u.value;else{var a=u.getElementsByTagName("input");for(var f=a.length-1,l;l=a[f--];)if(l.checked){t[o]=l.value;break}}else t[o]=!0}}var c=domUtils.getElementsByTagName(n,"select");for(var i=0,h;h=c[i++];){var p=h.getAttribute("name");t[p]=t[p]?h.value:""}e.editor.options.autotypeset=t}var e=baidu.editor.utils,t=baidu.editor.ui.Popup,n=baidu.editor.ui.AutoTypeSetPicker,r=baidu.editor.ui.SplitButton,i=baidu.editor.ui.AutoTypeSetButton=function(e){this.initOptions(e);this.initAutoTypeSetButton()};i.prototype={initAutoTypeSetButton:function(){var e=this;this.popup=new t({content:new n({editor:e.editor}),editor:e.editor,hide:function(){if(!this._hidden&&this.getDom()){s(this);this.getDom().style.display="none";this._hidden=!0;this.fireEvent("hide")}}});var r=0;this.popup.addListener("postRenderAfter",function(){var t=this;if(r)return;var n=this.getDom(),i=n.getElementsByTagName("button")[0];i.onclick=function(){s(t);e.editor.execCommand("autotypeset");t.hide()};r=1});this.initSplitButton()}};e.inherits(i,r)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,n=baidu.editor.ui.Stateful,r=baidu.editor.ui.UIBase,i=baidu.editor.ui.CellAlignPicker=function(e){this.initOptions(e);this.initCellAlignPicker()};i.prototype={initCellAlignPicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);"><tr><td index="0" stateful><div class="edui-icon edui-left"></div></td><td index="1" stateful><div class="edui-icon edui-center"></div></td><td index="2" stateful><div class="edui-icon edui-right"></div></td></tr><tr><td index="3" stateful><div class="edui-icon edui-left"></div></td><td index="4" stateful><div class="edui-icon edui-center"></div></td><td index="5" stateful><div class="edui-icon edui-right"></div></td></tr><tr><td index="6" stateful><div class="edui-icon edui-left"></div></td><td index="7" stateful><div class="edui-icon edui-center"></div></td><td index="8" stateful><div class="edui-icon edui-right"></div></td></tr></table></div></div>'},getStateDom:function(){return this.target},_onClick:function(e){var n=e.target||e.srcElement;if(/icon/.test(n.className)){this.items[n.parentNode.getAttribute("index")].onclick();t.postHide(e)}},_UIBase_render:r.prototype.render};e.inherits(i,r);e.extend(i.prototype,n,!0)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Stateful,n=baidu.editor.ui.uiUtils,r=baidu.editor.ui.UIBase,i=baidu.editor.ui.PastePicker=function(e){this.initOptions(e);this.initPastePicker()};i.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+"</div>"+'<div class="edui-button">'+'<div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful>'+'<div class="edui-richtxticon"></div></div>'+'<div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful>'+'<div class="edui-tagicon"></div></div>'+'<div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful>'+'<div class="edui-plaintxticon"></div></div>'+"</div>"+"</div>"+"</div>"},getStateDom:function(){return this.target},format:function(e){this.editor.ui._isTransfer=!0;this.editor.fireEvent("pasteTransfer",e)},_onClick:function(e){var t=domUtils.getNextDomNode(e),r=n.getViewportRect().height,i=n.getClientRect(t);i.top+i.height>r?t.style.top=-i.height-e.offsetHeight+"px":t.style.top="";if(/hidden/ig.test(domUtils.getComputedStyle(t,"visibility"))){t.style.visibility="visible";domUtils.addClass(e,"edui-state-opened")}else{t.style.visibility="hidden";domUtils.removeClasses(e,"edui-state-opened")}},_UIBase_render:r.prototype.render};e.inherits(i,r);e.extend(i.prototype,t,!0)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,r=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};r.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){var e=[];for(var t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+e.join("")+"</div>"},postRender:function(){var e=this.getDom();for(var n=0;n<this.items.length;n++)this.items[n].postRender();t.makeUnselectable(e)},_onMouseDown:function(){return!1}};e.inherits(r,n)})();(function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,r=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup,s=baidu.editor.ui.Stateful,o=baidu.editor.ui.CellAlignPicker,u=baidu.editor.ui.Menu=function(e){this.initOptions(e);this.initMenu()},a={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};u.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];if(t=="-")this.items[e]=this.getSeparator();else if(!(t instanceof f)){t.editor=this.editor;t.theme=this.editor.options.theme;this.items[e]=this.createItem(t)}}},getSeparator:function(){return a},createItem:function(e){return new f(e)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0)return this._Popup_getContentHtmlTpl();var e=[];for(var t=0;t<this.items.length;t++){var n=this.items[t];e[t]=n.renderHtml()}return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:i.prototype.postRender,postRender:function(){var e=this;for(var r=0;r<this.items.length;r++){var i=this.items[r];i.ownerMenu=this;i.postRender()}t.on(this.getDom(),"mouseover",function(t){t=t||event;var r=t.relatedTarget||t.fromElement,i=e.getDom();!n.contains(i,r)&&i!==r&&e.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(e){if(e){if(n.contains(this.getDom(),e))return!1;for(var t=0;t<this.items.length;t++){var r=this.items[t];if(r.queryAutoHide(e)===!1)return!1}}},clearItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];clearTimeout(t._showingTimer);clearTimeout(t._closingTimer);t.subMenu&&t.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&t.remove(this.getDom());this.clearItems()},dispose:function(){this.destroy()}};e.inherits(u,i);var f=baidu.editor.ui.MenuItem=function(e){this.initOptions(e);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof u))if(e.className&&e.className.indexOf("aligntd")!=-1){var n=this;this.subMenu=new i({content:new o(this.subMenu),parentMenu:n,editor:n.editor,destroy:function(){this.getDom()&&t.remove(this.getDom())}});this.subMenu.addListener("postRenderAfter",function(){t.on(this.getDom(),"mouseover",function(){n.addState("opened")})})}else this.subMenu=new u(this.subMenu)};f.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div>"+"</div>"},postRender:function(){var e=this;this.addListener("over",function(){e.ownerMenu.fireEvent("submenuover",e);e.subMenu&&e.delayShowSubMenu()});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){e.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(e._closingTimer);e._closingTimer=null;e.addState("opened")});this.ownerMenu.addListener("hide",function(){e.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(t,n){n!==e&&e.delayHideSubMenu()});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(t){return t&&n.contains(e.getDom(),t)?!1:this._bakQueryAutoHide(t)}}this.getDom().style.tabIndex="-1";n.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;if(!e.isDisabled()){e.addState("opened");clearTimeout(e._showingTimer);clearTimeout(e._closingTimer);e._closingTimer=null;e._showingTimer=setTimeout(function(){e.showSubMenu()},250)}},delayHideSubMenu:function(){var e=this;if(!e.isDisabled()){e.removeState("opened");clearTimeout(e._showingTimer);e._closingTimer||(e._closingTimer=setTimeout(function(){e.hasState("opened")||e.hideSubMenu();e._closingTimer=null},400))}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(e)},_onClick:function(e,t){if(this.hasState("disabled"))return;this.fireEvent("click",e,t)!==!1&&(this.subMenu?this.showSubMenu():i.postHide(e))},showSubMenu:function(){var e=n.getClientRect(this.getDom());e.right-=5;e.left+=2;e.width-=7;e.top-=4;e.bottom+=4;e.height+=8;this.subMenu.showAnchorRect(e,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}};e.inherits(f,r);e.extend(f.prototype,s,!0)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.Menu,r=baidu.editor.ui.SplitButton,i=baidu.editor.ui.Combox=function(e){this.initOptions(e);this.initCombox()};i.prototype={uiName:"combox",initCombox:function(){var e=this;this.items=this.items||[];for(var t=0;t<this.items.length;t++){var r=this.items[t];r.uiName="listitem";r.index=t;r.onclick=function(){e.selectByIndex(this.index)}}this.popup=new n({items:this.items,uiName:"list",editor:this.editor});this.initSplitButton()},_SplitButton_postRender:r.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var e=t.getClientRect(this.getDom());e.top+=1;e.bottom-=1;e.height-=2;this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var t=this.indexByValue(e);if(t!=-1){this.selectedIndex=t;this.setLabel(this.items[t].label);this.value=this.items[t].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(e));this.value=e}},setLabel:function(e){this.getDom("button_body").innerHTML=e;this.label=e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var t=0;t<this.items.length;t++)if(e==this.items[t].value)return t;return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){if(e<this.items.length&&this.fireEvent("select",e)!==!1){this.selectedIndex=e;this.value=this.items[e].value;this.setLabel(this.items[e].label)}}};e.inherits(i,r)})();(function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,r=baidu.editor.ui.Mask,i=baidu.editor.ui.UIBase,s=baidu.editor.ui.Button,o=baidu.editor.ui.Dialog=function(t){this.initOptions(e.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(e,t){return t?this.onok():this.oncancel()}},t));this.initDialog()},u,a;o.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var e=this,t=this.editor.options.theme;this.initUIBase();this.modalMask=u||(u=new r({className:"edui-dialog-modalmask",theme:t}));this.dragMask=a||(a=new r({className:"edui-dialog-dragmask",theme:t}));this.closeButton=new s({className:"edui-dialog-closebutton",title:e.closeDialog,theme:t,onclick:function(){e.close(!1)}});if(this.buttons)for(var n=0;n<this.buttons.length;n++)this.buttons[n]instanceof s||(this.buttons[n]=new s(this.buttons[n]))},fitSize:function(){var e=this.getDom("body"),t=this.mesureSize();e.style.width=t.width+"px";e.style.height=t.height+"px";return t},safeSetOffset:function(e){var t=this,r=t.getDom(),i=n.getViewportRect(),s=n.getClientRect(r),o=e.left;o+s.width>i.right&&(o=i.right-s.width);var u=e.top;u+s.height>i.bottom&&(u=i.bottom-s.height);r.style.left=Math.max(o,0)+"px";r.style.top=Math.max(u,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var e=n.getViewportRect(),r=this.fitSize(),i=this.getDom("titlebar").offsetHeight|0,s=e.width/2-r.width/2,o=e.height/2-(r.height-i)/2-i,u=this.getDom();this.safeSetOffset({left:Math.max(s|0,0),top:Math.max(o|0,0)});t.hasClass(u,"edui-state-centered")||(u.className+=" edui-state-centered");this._show()},getContentHtml:function(){var e="";typeof this.content=="string"?e=this.content:this.iframeUrl&&(e='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>');return e},getHtmlTpl:function(){var e="";if(this.buttons){var t=[];for(var n=0;n<this.buttons.length;n++)t[n]=this.buttons[n].renderHtml();e='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+t.join("")+"</div>"+"</div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span>"+"</div>"+this.closeButton.renderHtml()+"</div>"+'<div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+e+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var e=this;this.addListener("show",function(){e.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){e.modalMask.hide()});if(this.buttons)for(var r=0;r<this.buttons.length;r++)this.buttons[r].postRender();t.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e.safeSetOffset(n.getClientRect(e.getDom()))})});this._hide()},mesureSize:function(){var e=this.getDom("body"),t=n.getClientRect(this.getDom("content")).width,r=e.style;r.width=t;return n.getClientRect(e)},_onTitlebarMouseDown:function(e,r){if(this.draggable){var i,s=n.getViewportRect(),o=this;n.startDrag(e,{ondragstart:function(){i=n.getClientRect(o.getDom());o.getDom("contmask").style.visibility="visible";o.dragMask.show(o.getDom().style.zIndex-1)},ondragmove:function(e,t){var n=i.left+e,r=i.top+t;o.safeSetOffset({left:n,top:r})},ondragstop:function(){o.getDom("contmask").style.visibility="hidden";t.removeClasses(o.getDom(),["edui-state-centered"]);o.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=!1;this.fireEvent("show");baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){this.getDom().style.display="none";this.getDom().style.zIndex="";this._hidden=!0;this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(e){this.render();this.open()}this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(t){}},_onCloseButtonClick:function(e,t){this.close(!1)},close:function(e){this.fireEvent("close",e)!==!1&&this._hide()}};e.inherits(o,i)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Menu,n=baidu.editor.ui.SplitButton,r=baidu.editor.ui.MenuButton=function(e){this.initOptions(e);this.initMenuButton()};r.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton";this.popup=new t({items:e.items,className:e.className,editor:e.editor});this.popup.addListener("show",function(){var t=this;for(var n=0;n<t.items.length;n++){t.items[n].removeState("checked");if(t.items[n].value==e._value){t.items[n].addState("checked");this.value=e._value}}});this.initSplitButton()},setValue:function(e){this._value=e}};e.inherits(r,n)})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui,n=t.Dialog;t.buttons={};t.Dialog=function(e){var t=new n(e);t.addListener("hide",function(){if(t.editor){var e=t.editor;try{if(browser.gecko){var n=e.window.scrollY,r=e.window.scrollX;e.body.focus();e.window.scrollTo(r,n)}else e.focus()}catch(i){}}});return t};var r={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",highlightcode:"~/dialogs/highlightcode/highlightcode.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html"},i=["undo","redo","formatmatch","bold","italic","underline","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable"];for(var s=0,o;o=i[s++];){o=o.toLowerCase();t[o]=function(e){return function(n){var r=new t.Button({className:"edui-for-"+e,title:n.options.labelMap[e]||n.getLang("labelMap."+e)||"",onclick:function(){n.execCommand(e)},theme:n.options.theme,showText:!1});t.buttons[e]=r;n.addListener("selectionchange",function(t,i,s){var o=n.queryCommandState(e);if(o==-1){r.setDisabled(!0);r.setChecked(!1)}else if(!s){r.setDisabled(!1);r.setChecked(o)}});return r}}(o)}t.cleardoc=function(e){var n=new t.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",theme:e.options.theme,onclick:function(){confirm(e.getLang("confirmClear"))&&e.execCommand("cleardoc")}});t.buttons.cleardoc=n;e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState("cleardoc")==-1)});return n};var u={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var a in u)(function(e,n){for(var r=0,i;i=n[r++];)(function(n){t[e.replace("float","")+n]=function(r){var i=new t.Button({className:"edui-for-"+e.replace("float","")+n,title:r.options.labelMap[e.replace("float","")+n]||r.getLang("labelMap."+e.replace("float","")+n)||"",theme:r.options.theme,onclick:function(){r.execCommand(e,n)}});t.buttons[e]=i;r.addListener("selectionchange",function(t,s,o){i.setDisabled(r.queryCommandState(e)==-1);i.setChecked(r.queryCommandValue(e)==n&&!o)});return i}})(i)})(a,u[a]);for(var s=0,o;o=["backcolor","forecolor"][s++];)t[o]=function(e){return function(n){var r=new t.ColorButton({className:"edui-for-"+e,color:"default",title:n.options.labelMap[e]||n.getLang("labelMap."+e)||"",editor:n,onpickcolor:function(t,r){n.execCommand(e,r)},onpicknocolor:function(){n.execCommand(e,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){n.execCommand(e,this.color)}});t.buttons[e]=r;n.addListener("selectionchange",function(){r.setDisabled(n.queryCommandState(e)==-1)});return r}}(o);var f={noOk:["searchreplace","help","spechars","webapp"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","highlightcode","insertframe","edittip","edittable","edittd","scrawl","template","music","background"]};for(var a in f)(function(n,i){for(var s=0,o;o=i[s++];){if(browser.opera&&o==="searchreplace")continue;(function(i){t[i]=function(s,o,u){o=o||(s.options.iframeUrlMap||{})[i]||r[i];u=s.options.labelMap[i]||s.getLang("labelMap."+i)||"";var a;if(o){a=new t.Dialog(e.extend({iframeUrl:s.ui.mapUrl(o),editor:s,className:"edui-for-"+i,title:u,closeDialog:s.getLang("closeDialog")},n=="ok"?{buttons:[{className:"edui-okbutton",label:s.getLang("ok"),editor:s,onclick:function(){a.close(!0)}},{className:"edui-cancelbutton",label:s.getLang("cancel"),editor:s,onclick:function(){a.close(!1)}}]}:{}));s.ui._dialogs[i+"Dialog"]=a}var f=new t.Button({className:"edui-for-"+i,title:u,onclick:function(){if(a)switch(i){case"wordimage":s.execCommand("wordimage","word_img");if(s.word_img){a.render();a.open()}break;case"scrawl":if(s.queryCommandState("scrawl")!=-1){a.render();a.open()}break;default:a.render();a.open()}},theme:s.options.theme,disabled:i=="scrawl"&&s.queryCommandState("scrawl")==-1});t.buttons[i]=f;s.addListener("selectionchange",function(){var e={edittable:1};if(i in e)return;var t=s.queryCommandState(i);if(f.getDom()){f.setDisabled(t==-1);f.setChecked(t)}});return f}})(o.toLowerCase())}})(a,f[a]);t.snapscreen=function(e,n,i){i=e.options.labelMap.snapscreen||e.getLang("labelMap.snapscreen")||"";var s=new t.Button({className:"edui-for-snapscreen",title:i,onclick:function(){e.execCommand("snapscreen")},theme:e.options.theme});t.buttons.snapscreen=s;n=n||(e.options.iframeUrlMap||{}).snapscreen||r.snapscreen;if(n){var o=new t.Dialog({iframeUrl:e.ui.mapUrl(n),editor:e,className:"edui-for-snapscreen",title:i,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),editor:e,onclick:function(){o.close(!0)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),editor:e,onclick:function(){o.close(!1)}}]});o.render();e.ui._dialogs.snapscreenDialog=o}e.addListener("selectionchange",function(){s.setDisabled(e.queryCommandState("snapscreen")==-1)});return s};t.fontfamily=function(n,r,i){r=n.options.fontfamily||[];i=n.options.labelMap.fontfamily||n.getLang("labelMap.fontfamily")||"";if(!r.length)return;for(var s=0,o,u=[];o=r[s];s++){var a=n.getLang("fontfamily")[o.name]||"";(function(t,r){u.push({label:t,value:r,theme:n.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+e.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(o.label||a,o.val)}var f=new t.Combox({editor:n,items:u,onselect:function(e,t){n.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:i,initValue:i,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t=0,n;n=this.items[t];t++)if(n.value.indexOf(e)!=-1)return t;return-1}});t.buttons.fontfamily=f;n.addListener("selectionchange",function(e,t,r){if(!r){var i=n.queryCommandState("FontFamily");if(i==-1)f.setDisabled(!0);else{f.setDisabled(!1);var s=n.queryCommandValue("FontFamily");s&&(s=s.replace(/['"]/g,"").split(",")[0]);f.setValue(s)}}});return f};t.fontsize=function(e,n,r){r=e.options.labelMap.fontsize||e.getLang("labelMap.fontsize")||"";n=n||e.options.fontsize||[];if(!n.length)return;var i=[];for(var s=0;s<n.length;s++){var o=n[s]+"px";i.push({label:o,value:o,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var u=new t.Combox({editor:e,items:i,title:r,initValue:r,onselect:function(t,n){e.execCommand("FontSize",this.items[n].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});t.buttons.fontsize=u;e.addListener("selectionchange",function(t,n,r){if(!r){var i=e.queryCommandState("FontSize");if(i==-1)u.setDisabled(!0);else{u.setDisabled(!1);u.setValue(e.queryCommandValue("FontSize"))}}});return u};t.paragraph=function(n,r,i){i=n.options.labelMap.paragraph||n.getLang("labelMap.paragraph")||"";r=n.options.paragraph||[];if(e.isEmptyObject(r))return;var s=[];for(var o in r)s.push({value:o,label:r[o]||n.getLang("paragraph")[o],theme:n.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var u=new t.Combox({editor:n,items:s,title:i,initValue:i,className:"edui-for-paragraph",onselect:function(e,t){n.execCommand("Paragraph",this.items[t].value)},onbuttonclick:function(){this.showPopup()}});t.buttons.paragraph=u;n.addListener("selectionchange",function(e,t,r){if(!r){var i=n.queryCommandState("Paragraph");if(i==-1)u.setDisabled(!0);else{u.setDisabled(!1);var s=n.queryCommandValue("Paragraph"),o=u.indexByValue(s);o!=-1?u.setValue(s):u.setValue(u.initValue)}}});return u};t.customstyle=function(e){var n=e.options.customstyle||[],r=e.options.labelMap.customstyle||e.getLang("labelMap.customstyle")||"";if(!n.length)return;var i=e.getLang("customstyle");for(var s=0,o=[],u;u=n[s++];)(function(t){var n={};n.label=t.label?t.label:i[t.name];n.style=t.style;n.className=t.className;n.tag=t.tag;o.push({label:n.label,value:n,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+n.tag+" "+(n.className?' class="'+n.className+'"':"")+(n.style?' style="'+n.style+'"':"")+">"+n.label+"</"+n.tag+">"+"</div>"}})})(u);var a=new t.Combox({editor:e,items:o,title:r,initValue:r,className:"edui-for-customstyle",onselect:function(t,n){e.execCommand("customstyle",this.items[n].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t=0,n;n=this.items[t++];)if(n.label==e)return t-1;return-1}});t.buttons.customstyle=a;e.addListener("selectionchange",function(t,n,r){if(!r){var i=e.queryCommandState("customstyle");if(i==-1)a.setDisabled(!0);else{a.setDisabled(!1);var s=e.queryCommandValue("customstyle"),o=a.indexByValue(s);o!=-1?a.setValue(s):a.setValue(a.initValue)}}});return a};t.inserttable=function(e,n,r){r=e.options.labelMap.inserttable||e.getLang("labelMap.inserttable")||"";var i=new t.TableButton({editor:e,title:r,className:"edui-for-inserttable",onpicktable:function(t,n,r){e.execCommand("InsertTable",{numRows:r,numCols:n,border:1})},onbuttonclick:function(){this.showPopup()}});t.buttons.inserttable=i;e.addListener("selectionchange",function(){i.setDisabled(e.queryCommandState("inserttable")==-1)});return i};t.lineheight=function(e){var n=e.options.lineheight||[];if(!n.length)return;for(var r=0,i,s=[];i=n[r++];)s.push({label:i,value:i,theme:e.options.theme,onclick:function(){e.execCommand("lineheight",this.value)}});var o=new t.MenuButton({editor:e,className:"edui-for-lineheight",title:e.options.labelMap.lineheight||e.getLang("labelMap.lineheight")||"",items:s,onbuttonclick:function(){var t=e.queryCommandValue("LineHeight")||this.value;e.execCommand("LineHeight",t)}});t.buttons.lineheight=o;e.addListener("selectionchange",function(){var t=e.queryCommandState("LineHeight");if(t==-1)o.setDisabled(!0);else{o.setDisabled(!1);var n=e.queryCommandValue("LineHeight");n&&o.setValue((n+"").replace(/cm/,""));o.setChecked(t)}});return o};var l=["top","bottom"];for(var c=0,h;h=l[c++];)(function(e){t["rowspacing"+e]=function(n){var r=n.options["rowspacing"+e]||[];if(!r.length)return null;for(var i=0,s,o=[];s=r[i++];)o.push({label:s,value:s,theme:n.options.theme,onclick:function(){n.execCommand("rowspacing",this.value,e)}});var u=new t.MenuButton({editor:n,className:"edui-for-rowspacing"+
e,title:n.options.labelMap["rowspacing"+e]||n.getLang("labelMap.rowspacing"+e)||"",items:o,onbuttonclick:function(){var t=n.queryCommandValue("rowspacing",e)||this.value;n.execCommand("rowspacing",t,e)}});t.buttons[e]=u;n.addListener("selectionchange",function(){var t=n.queryCommandState("rowspacing",e);if(t==-1)u.setDisabled(!0);else{u.setDisabled(!1);var r=n.queryCommandValue("rowspacing",e);r&&u.setValue((r+"").replace(/%/,""));u.setChecked(t)}});return u}})(h);var p=["insertorderedlist","insertunorderedlist"];for(var d=0,v;v=p[d++];)(function(e){t[e]=function(n){var r=n.options[e],i=function(){n.execCommand(e,this.value)},s=[];for(var o in r)s.push({label:r[o]||n.getLang()[e][o]||"",value:o,theme:n.options.theme,onclick:i});var u=new t.MenuButton({editor:n,className:"edui-for-"+e,title:n.getLang("labelMap."+e)||"",items:s,onbuttonclick:function(){var t=n.queryCommandValue(e)||this.value;n.execCommand(e,t)}});t.buttons[e]=u;n.addListener("selectionchange",function(){var t=n.queryCommandState(e);if(t==-1)u.setDisabled(!0);else{u.setDisabled(!1);var r=n.queryCommandValue(e);u.setValue(r);u.setChecked(t)}});return u}})(v);t.fullscreen=function(e,n){n=e.options.labelMap.fullscreen||e.getLang("labelMap.fullscreen")||"";var r=new t.Button({className:"edui-for-fullscreen",title:n,theme:e.options.theme,onclick:function(){e.ui&&e.ui.setFullScreen(!e.ui.isFullScreen());this.setChecked(e.ui.isFullScreen())}});t.buttons.fullscreen=r;e.addListener("selectionchange",function(){var t=e.queryCommandState("fullscreen");r.setDisabled(t==-1);r.setChecked(e.ui.isFullScreen())});return r};t.emotion=function(e,n){var i=new t.MultiMenuPop({title:e.options.labelMap.emotion||e.getLang("labelMap.emotion")||"",editor:e,className:"edui-for-emotion",iframeUrl:e.ui.mapUrl(n||(e.options.iframeUrlMap||{}).emotion||r.emotion)});t.buttons.emotion=i;e.addListener("selectionchange",function(){i.setDisabled(e.queryCommandState("emotion")==-1)});return i};t.autotypeset=function(e){var n=new t.AutoTypeSetButton({editor:e,title:e.options.labelMap.autotypeset||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});t.buttons.autotypeset=n;e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState("autotypeset")==-1)});return n}})();(function(){function s(e){this.initOptions(e);this.initEditorUI()}var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,r=baidu.editor.dom.domUtils,i=[];s.prototype={uiName:"editor",initEditorUI:function(){function o(e,t){e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var n=e.options,r=n.maximumWords,i=n.wordCountMsg,s=n.wordOverFlowMsg,o=t.getDom("wordcount");if(!n.wordCount)return;var u=e.getContentLength(!0);if(u>r){o.innerHTML=s;e.fireEvent("wordcountoverflow")}else o.innerHTML=i.replace("{#leave}",r-u).replace("{#count}",u)}this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var e=this.editor,t=this;e.addListener("ready",function(){e.getDialog=function(t){return e.ui._dialogs[t+"Dialog"]};r.on(e.window,"scroll",function(e){baidu.editor.ui.Popup.postHide(e)});e.ui._actualFrameWidth=e.options.initialFrameWidth;e.options.elementPathEnabled&&(e.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+e.getLang("elementPathTip")+":</div>");if(e.options.wordCount){function n(){o(e,t);r.un(e.document,"click",arguments.callee)}r.on(e.document,"click",n);e.ui.getDom("wordcount").innerHTML=e.getLang("wordCountTip")}e.ui._scale();if(e.options.scaleEnabled){e.autoHeightEnabled&&e.disableAutoHeight();t.enableScale()}else t.disableScale();if(!e.options.elementPathEnabled&&!e.options.wordCount&&!e.options.scaleEnabled){e.ui.getDom("elementpath").style.display="none";e.ui.getDom("wordcount").style.display="none";e.ui.getDom("scale").style.display="none"}if(!e.selection.isFocus())return;e.fireEvent("selectionchange",!1,!0)});e.addListener("mousedown",function(e,t){var n=t.target||t.srcElement;baidu.editor.ui.Popup.postHide(t,n)});e.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(e);e.getDialog("edittip").open()});var n,i=!1,s;e.addListener("afterpaste",function(){if(e.queryCommandState("pasteplain"))return;n=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:e}),editor:e,className:"edui-wordpastepop"});n.render();i=!0});e.addListener("afterinserthtml",function(){clearTimeout(s);s=setTimeout(function(){if(n&&(i||e.ui._isTransfer)){var t=r.createElement(e.document,"span",{style:"line-height:0px;",innerHTML:"﻿"}),s=e.selection.getRange();s.insertNode(t);n.showAnchor(t);r.remove(t);delete e.ui._isTransfer;i=!1}},200)});e.addListener("contextmenu",function(e,t){baidu.editor.ui.Popup.postHide(t)});e.addListener("keydown",function(e,t){n&&n.dispose(t);var r=t.keyCode||t.which;t.altKey&&r==90&&UE.ui.buttons.fullscreen.onclick()});e.addListener("wordcount",function(e){o(this,t)});e.addListener("selectionchange",function(){e.options.elementPathEnabled&&t[(e.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]();e.options.scaleEnabled&&t[(e.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()});var u=new baidu.editor.ui.Popup({editor:e,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();e.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(t){this.hide();e.ui._dialogs[t]&&e.ui._dialogs[t].open()},_onImgSetFloat:function(t){this.hide();e.execCommand("imagefloat",t)},_setIframeAlign:function(e){var t=u.anchorEl,n=t.cloneNode(!0);switch(e){case-2:n.setAttribute("align","");break;case-1:n.setAttribute("align","left");break;case 1:n.setAttribute("align","right")}t.parentNode.insertBefore(n,t);r.remove(t);u.anchorEl=n;u.showAnchor(u.anchorEl)},_updateIframe:function(){e._iframe=u.anchorEl;e.ui._dialogs.insertframeDialog.open();u.hide()},_onRemoveButtonClick:function(t){e.execCommand(t);this.hide()},queryAutoHide:function(t){if(t&&t.ownerDocument==e.document)if(t.tagName.toLowerCase()=="img"||r.findParentByTagName(t,"a",!0))return t!==u.anchorEl;return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,t)}});u.render();if(e.options.imagePopup){e.addListener("mouseover",function(t,n){n=n||window.event;var r=n.target||n.srcElement;if(e.ui._dialogs.insertframeDialog&&/iframe/ig.test(r.tagName)){var i=u.formatHtml("<nobr>"+e.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+e.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+e.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+e.getLang("justifyright")+"</span>&nbsp;&nbsp;"+' <span onclick="$$._updateIframe( this);" class="edui-clickable">'+e.getLang("modify")+"</span></nobr>");if(i){u.getDom("content").innerHTML=i;u.anchorEl=r;u.showAnchor(u.anchorEl)}else u.hide()}});e.addListener("selectionchange",function(t,n){if(!n)return;var r="",i="",s=e.selection.getRange().getClosedNode(),o=e.ui._dialogs;if(s&&s.tagName=="IMG"){var a="insertimageDialog";s.className.indexOf("edui-faked-video")!=-1&&(a="insertvideoDialog");s.className.indexOf("edui-faked-webapp")!=-1&&(a="webappDialog");s.src.indexOf("http://api.map.baidu.com")!=-1&&(a="mapDialog");s.className.indexOf("edui-faked-music")!=-1&&(a="musicDialog");s.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1&&(a="gmapDialog");if(s.getAttribute("anchorname")){a="anchorDialog";r=u.formatHtml("<nobr>"+e.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+e.getLang("modify")+"</span>&nbsp;&nbsp;"+"<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+e.getLang("delete")+"</span></nobr>")}if(s.getAttribute("word_img")){e.word_img=[s.getAttribute("word_img")];a="wordimageDialog"}if(!o[a])return;i="<nobr>"+e.getLang("property")+": "+'<span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+e.getLang("default")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+e.getLang("justifyleft")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+e.getLang("justifyright")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+e.getLang("justifycenter")+"</span>&nbsp;&nbsp;"+"<span onclick=\"$$._onImgEditButtonClick('"+a+'\');" class="edui-clickable">'+e.getLang("modify")+"</span></nobr>";!r&&(r=u.formatHtml(i))}if(e.ui._dialogs.linkDialog){var f=e.queryCommandValue("link"),l;if(f&&(l=f.getAttribute("data_ue_src")||f.getAttribute("href",2))){var c=l;l.length>30&&(c=l.substring(0,20)+"...");r&&(r+='<div style="height:5px;"></div>');r+=u.formatHtml("<nobr>"+e.getLang("anthorMsg")+': <a target="_blank" href="'+l+'" title="'+l+'" >'+c+"</a>"+' <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+e.getLang("modify")+"</span>"+' <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+e.getLang("clear")+"</span></nobr>");u.showAnchor(f)}}if(r){u.getDom("content").innerHTML=r;u.anchorEl=s||f;u.showAnchor(u.anchorEl)}else u.hide()})}},_initToolbars:function(){var e=this.editor,t=this.toolbars||[],n=[];for(var r=0;r<t.length;r++){var i=t[r],s=new baidu.editor.ui.Toolbar({theme:e.options.theme});for(var o=0;o<i.length;o++){var u=i[o],a=null;if(typeof u=="string"){u=u.toLowerCase();u=="|"&&(u="Separator");baidu.editor.ui[u]&&(a=new baidu.editor.ui[u](e));if(u=="fullscreen"){n&&n[0]?n[0].items.splice(0,0,a):a&&s.items.splice(0,0,a);continue}}else a=u;a&&a.id&&s.add(a)}n[r]=s}this.toolbars=n},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;">'+'<div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+"</div>"+'<div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div>'+'<div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div>'+'<div style="height:0;overflow:hidden;clear:both;"></div>'+"</div>"+"</div>"+'<div id="##_iframeholder" class="%%-iframeholder"></div>'+'<div id="##_bottombar" class="%%-bottomContainer"><table><tr>'+'<td id="##_elementpath" class="%%-bottombar"></td>'+'<td id="##_wordcount" class="%%-wordcount"></td>'+'<td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td>'+"</tr></table></div>"+'<div id="##_scalelayer"></div>'+"</div>"},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){var e=[];for(var t=0;t<this.toolbars.length;t++)e.push(this.toolbars[t].renderHtml());return e.join("")},setFullScreen:function(e){var t=this.editor,n=t.container.parentNode.parentNode;if(this._fullscreen!=e){this._fullscreen=e;this.editor.fireEvent("beforefullscreenchange",e);if(baidu.editor.browser.gecko)var r=t.selection.getRange().createBookmark();if(e){while(n.tagName!="BODY"){var s=baidu.editor.dom.domUtils.getComputedStyle(n,"position");i.push(s);n.style.position="static";n=n.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this._bakAutoHeight){t.autoHeightEnabled=!1;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;this._updateFullScreen()}else{while(n.tagName!="BODY"){n.style.position=i.shift();n=n.parentNode}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){t.autoHeightEnabled=!0;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;window.scrollTo(0,this._bakScrollTop)}if(baidu.editor.browser.gecko){var o=document.createElement("input");document.body.appendChild(o);t.body.contentEditable=!1;setTimeout(function(){o.focus();setTimeout(function(){t.body.contentEditable=!0;t.selection.getRange().moveToBookmark(r).select(!0);baidu.editor.dom.domUtils.remove(o);e&&window.scroll(0,0)},0)},0)}this.editor.fireEvent("fullscreenchanged",e);this.triggerLayout()}},_updateFullScreen:function(){if(this._fullscreen){var e=t.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);t.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0))}},_updateElementPath:function(){var e=this.getDom("elementpath"),t;if(this.elementPathEnabled&&(t=this.editor.queryCommandValue("elementpath"))){var n=[];for(var r=0,i;i=t[r];r++)n[r]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+r+'&quot;);">'+i+"</span>");e.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+n.join(" &gt; ")+"</div>"}else e.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="";e.style.display="none";this.elementPathEnabled=!1},enableElementPath:function(){var e=this.getDom("elementpath");e.style.display="";this.elementPathEnabled=!0;this._updateElementPath()},_scale:function(){function g(){l=r.getXY(n);c||(c=t.options.minFrameHeight+s.offsetHeight+o.offsetHeight);a.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+n.offsetWidth+"px;height:"+n.offsetHeight+"px;z-index:"+(t.options.zIndex+1);r.on(e,"mousemove",b);r.on(i,"mouseup",w);r.on(e,"mouseup",w)}function b(t){E();var n=t||window.event;p=n.pageX||e.documentElement.scrollLeft+n.clientX;d=n.pageY||e.documentElement.scrollTop+n.clientY;v=p-l.x;m=d-l.y;if(v>=h){f=!0;a.style.width=v+"px"}if(m>=c){f=!0;a.style.height=m+"px"}}function w(){if(f){f=!1;t.ui._actualFrameWidth=a.offsetWidth-2;n.style.width=t.ui._actualFrameWidth+"px";t.setHeight(a.offsetHeight-o.offsetHeight-s.offsetHeight-2)}a&&(a.style.display="none");E();r.un(e,"mousemove",b);r.un(i,"mouseup",w);r.un(e,"mouseup",w)}function E(){browser.ie?e.selection.clear():window.getSelection().removeAllRanges()}var e=document,t=this.editor,n=t.container,i=t.document,s=this.getDom("toolbarbox"),o=this.getDom("bottombar"),u=this.getDom("scale"),a=this.getDom("scalelayer"),f=!1,l=null,c=0,h=t.options.minFrameWidth,p=0,d=0,v=0,m=0,y=this;this.editor.addListener("fullscreenchanged",function(e,t){if(t)y.disableScale();else if(y.editor.options.scaleEnabled){y.enableScale();var n=y.editor.document.createElement("span");y.editor.body.appendChild(n);y.editor.body.style.height=Math.max(r.getXY(n).y,y.editor.iframe.offsetHeight-20)+"px";r.remove(n)}});this.enableScale=function(){if(t.queryCommandState("source")==1)return;u.style.display="";this.scaleEnabled=!0;r.on(u,"mousedown",g)};this.disableScale=function(){u.style.display="none";this.scaleEnabled=!1;r.un(u,"mousedown",g)}},isFullScreen:function(){return this._fullscreen},postRender:function(){n.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();var t=this,r,i=baidu.editor.dom.domUtils,s=function(){clearTimeout(r);r=setTimeout(function(){t._updateFullScreen()})};i.on(window,"resize",s);t.addListener("destroy",function(){i.un(window,"resize",s);clearTimeout(r)})},showToolbarMsg:function(e,t){this.getDom("toolbarmsg_label").innerHTML=e;this.getDom("toolbarmsg").style.display="";if(!t){var n=this.getDom("upload_dialog");n.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();e.style.zoom=="1"?e.style.zoom="100%":e.style.zoom="1"}};e.inherits(s,baidu.editor.ui.UIBase);var o={};UE.ui.Editor=function(t){var n=new baidu.editor.Editor(t);n.options.editor=n;e.loadFile(document,{href:n.options.themePath+n.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var i=n.render;n.render=function(t){if(t.constructor===String){n.key=t;o[t]=n}e.domReady(function(){function e(){n.setOpt({labelMap:n.options.labelMap||n.getLang("labelMap")});new s(n.options);if(t){t.constructor===String&&(t=document.getElementById(t));t&&t.getAttribute("name")&&(n.options.textarea=t.getAttribute("name"));if(t&&/script|textarea/ig.test(t.tagName)){var e=document.createElement("div");t.parentNode.insertBefore(e,t);var o=t.value||t.innerHTML;n.options.initialContent=/^[\t\r\n ]*$/.test(o)?n.options.initialContent:o.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");t.className&&(e.className=t.className);t.style.cssText&&(e.style.cssText=t.style.cssText);if(/textarea/i.test(t.tagName)){n.textarea=t;n.textarea.style.display="none"}else{t.parentNode.removeChild(t);t.id&&(e.id=t.id)}t=e;t.innerHTML=""}}r.addClass(t,"edui-"+n.options.theme);n.ui.render(t);var u=n.ui.getDom("iframeholder");n.container=n.ui.getDom();var a=n.options.initialFrameWidth;/%/g.test(a)||(a+="px");n.container.style.cssText="z-index:"+n.options.zIndex+";width:"+a;i.call(n,u)}n.langIsReady?e():n.addListener("langReady",e)})};return n};UE.getEditor=function(e,t){var n=o[e];if(!n){n=o[e]=new UE.ui.Editor(t);n.render(e)}return n};UE.delEditor=function(e){var t;if(t=o[e]){t.key&&t.destroy();delete o[e]}}})();(function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,n=baidu.editor.ui.SplitButton,r=baidu.editor.ui.MultiMenuPop=function(e){this.initOptions(e);this.initMultiMenu()};r.prototype={initMultiMenu:function(){var e=this;this.popup=new t({content:"",editor:e.editor,iframe_rendered:!1,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=!0;this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>';e.editor.container.style.zIndex&&(this.getDom().style.zIndex=e.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};e.inherits(r,n)})();UE.commands.inserthtml={execCommand:function(e,t,n){var r=this,i,s;if(!t)return;i=r.selection.getRange();s=i.document.createElement("div");s.style.display="inline";var o=r.serialize;if(!n&&o){var u=o.parseHTML(t);u=o.transformInput(u);u=o.filter(u);t=o.toHTML(u)}s.innerHTML=utils.trim(t);if(!i.collapsed){var a=i.startContainer;domUtils.isFillChar(a)&&i.setStartBefore(a);a=i.endContainer;domUtils.isFillChar(a)&&i.setEndAfter(a);i.txtToElmBoundary();if(i.endContainer&&i.endContainer.nodeType==1){a=i.endContainer.childNodes[i.endOffset];a&&domUtils.isBr(a)&&i.setEndAfter(a)}if(i.startOffset==0){a=i.startContainer;if(domUtils.isBoundaryNode(a,"firstChild")){a=i.endContainer;if(i.endOffset==(a.nodeType==3?a.nodeValue.length:a.childNodes.length)&&domUtils.isBoundaryNode(a,"lastChild")){r.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";i.setStart(r.body.firstChild,0).collapse(!0)}}}!i.collapsed&&i.deleteContents();if(i.startContainer.nodeType==1){var f=i.startContainer.childNodes[i.startOffset],l;if(f&&domUtils.isBlockElm(f)&&(l=f.previousSibling)&&domUtils.isBlockElm(l)){i.setEnd(l,l.childNodes.length).collapse();while(f.firstChild)l.appendChild(f.firstChild);domUtils.remove(f)}}}var f,c,l,h,p=0,d;if(i.inFillChar()){f=i.startContainer;i.setStartBefore(f).collapse(!0);domUtils.remove(f)}while(f=s.firstChild){i.insertNode(f);d=f.nextSibling;if(!p&&f.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(f)){c=domUtils.findParent(f,function(e){return domUtils.isBlockElm(e)});if(c&&c.tagName.toLowerCase()!="body"&&(!dtd[c.tagName][f.nodeName]||f.parentNode!==c)){if(!dtd[c.tagName][f.nodeName])l=c;else{h=f.parentNode;while(h!==c){l=h;h=h.parentNode}}domUtils.breakParent(f,l||h);var l=f.previousSibling;domUtils.trimWhiteTextNode(l);l.childNodes.length||domUtils.remove(l);!browser.ie&&(v=f.nextSibling)&&domUtils.isBlockElm(v)&&v.lastChild&&!domUtils.isBr(v.lastChild)&&v.appendChild(r.document.createElement("br"));p=1}}var v=f.nextSibling;if(!s.firstChild&&v&&domUtils.isBlockElm(v)){i.setStart(v,0).collapse(!0);break}i.setEndAfter(f).collapse()}f=i.startContainer;d&&domUtils.isBr(d)&&domUtils.remove(d);if(domUtils.isBlockElm(f)&&domUtils.isEmptyNode(f))if(d=f.nextSibling){domUtils.remove(f);d.nodeType==1&&dtd.$block[d.tagName]&&i.setStart(d,0).collapse(!0).shrinkBoundary()}else f.innerHTML=browser.ie?domUtils.fillChar:"<br/>";i.select(!0);setTimeout(function(){i=r.selection.getRange();i.scrollToView(r.autoHeightEnabled,r.autoHeightEnabled?domUtils.getXY(r.iframe).y:0);r.fireEvent("afterinserthtml")},200)}};UE.commands.imagefloat={execCommand:function(e,t){var n=this,r=n.selection.getRange();if(!r.collapsed){var i=r.getClosedNode();if(i&&i.tagName=="IMG")switch(t){case"left":case"right":case"none":var s=i.parentNode,o,u,a;while(dtd.$inline[s.tagName]||s.tagName=="A")s=s.parentNode;o=s;if(o.tagName=="P"&&domUtils.getStyle(o,"text-align")=="center"){if(!domUtils.isBody(o)&&domUtils.getChildCount(o,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1){u=o.previousSibling;a=o.nextSibling;if(u&&a&&u.nodeType==1&&a.nodeType==1&&u.tagName==a.tagName&&domUtils.isBlockElm(u)){u.appendChild(o.firstChild);while(a.firstChild)u.appendChild(a.firstChild);domUtils.remove(o);domUtils.remove(a)}else domUtils.setStyle(o,"text-align","")}r.selectNode(i).select()}domUtils.setStyle(i,"float",t=="none"?"":t);t=="none"&&domUtils.removeAttributes(i,"align");break;case"center":if(n.queryCommandValue("imagefloat")!="center"){s=i.parentNode;domUtils.setStyle(i,"float","");domUtils.removeAttributes(i,"align");o=i;while(s&&domUtils.getChildCount(s,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1&&(dtd.$inline[s.tagName]||s.tagName=="A")){o=s;s=s.parentNode}r.setStartBefore(o).setCursor(!1);s=n.document.createElement("div");s.appendChild(o);domUtils.setStyle(o,"float","");n.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+s.innerHTML+"</p>");o=n.document.getElementById("_img_parent_tmp");o.removeAttribute("id");o=o.firstChild;r.selectNode(o).select();a=o.parentNode.nextSibling;a&&domUtils.isEmptyNode(a)&&domUtils.remove(a)}}}},queryCommandValue:function(){var e=this.selection.getRange(),t,n;if(e.collapsed)return"none";t=e.getClosedNode();if(t&&t.nodeType==1&&t.tagName=="IMG"){n=t.getAttribute("align")||domUtils.getComputedStyle(t,"float");n=="none"&&(n=domUtils.getComputedStyle(t.parentNode,"text-align")=="center"?"center":n);return{left:1,right:1,center:1}[n]?n:"none"}return"none"},queryCommandState:function(){var e=this.selection.getRange(),t;if(e.collapsed)return-1;t=e.getClosedNode();return t&&t.nodeType==1&&t.tagName=="IMG"?0:-1}};UE.commands.insertimage={execCommand:function(e,t){t=utils.isArray(t)?t:[t];if(!t.length)return;var n=this,r=n.selection.getRange(),i=r.getClosedNode();if(i&&/img/i.test(i.tagName)&&i.className!="edui-faked-video"&&!i.getAttribute("word_img")){var s=t.shift(),o=s.floatStyle;delete s.floatStyle;domUtils.setAttributes(i,s);n.execCommand("imagefloat",o);if(t.length>0){r.setStartAfter(i).setCursor(!1,!0);n.execCommand("insertimage",t)}}else{var u=[],a="",f;f=t[0];if(t.length==1){a='<img src="'+f.src+'" '+(f.data_ue_src?' data_ue_src="'+f.data_ue_src+'" ':"")+(f.width?'width="'+f.width+'" ':"")+(f.height?' height="'+f.height+'" ':"")+(f["floatStyle"]=="left"||f["floatStyle"]=="right"?' style="float:'+f.floatStyle+';"':"")+(f.title&&f.title!=""?' title="'+f.title+'"':"")+(f.border&&f.border!="0"?' border="'+f.border+'"':"")+(f.alt&&f.alt!=""?' alt="'+f.alt+'"':"")+(f.hspace&&f.hspace!="0"?' hspace = "'+f.hspace+'"':"")+(f.vspace&&f.vspace!="0"?' vspace = "'+f.vspace+'"':"")+"/>";f["floatStyle"]=="center"&&(a='<p style="text-align: center">'+a+"</p>");u.push(a)}else for(var l=0;f=t[l++];){a="<p "+(f["floatStyle"]=="center"?'style="text-align: center" ':"")+'><img src="'+f.src+'" '+(f.width?'width="'+f.width+'" ':"")+(f.data_ue_src?' data_ue_src="'+f.data_ue_src+'" ':"")+(f.height?' height="'+f.height+'" ':"")+' style="'+(f.floatStyle&&f["floatStyle"]!="center"?"float:"+f.floatStyle+";":"")+(f.border||"")+'" '+(f.title?' title="'+f.title+'"':"")+" /></p>";u.push(a)}n.execCommand("insertHtml",u.join(""))}}};UE.plugins.basestyle=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},t=function(e,t){return domUtils.filterNodeList(e.selection.getStartElementPath(),t)},n=this;n.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});for(var r in e)(function(e,r){n.commands[e]={execCommand:function(e){var i=n.selection.getRange(),s=t(this,r);if(i.collapsed){if(s){var o=n.document.createTextNode("");i.insertNode(o).removeInlineStyle(r);i.setStartBefore(o);domUtils.remove(o)}else{var u=i.document.createElement(r[0]);if(e=="superscript"||e=="subscript"){o=n.document.createTextNode("");i.insertNode(o).removeInlineStyle(["sub","sup"]).setStartBefore(o).collapse(!0)}i.insertNode(u).setStart(u,0)}i.collapse(!0)}else{(e=="superscript"||e=="subscript")&&(!s||s.tagName.toLowerCase()!=e)&&i.removeInlineStyle(["sub","sup"]);s?i.removeInlineStyle(r):i.applyInlineStyle(r[0])}i.select()},queryCommandState:function(){return t(this,r)?1:0}}})(r,e[r])};UE.plugins.removeformat=function(){var e=this;e.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});e.commands.removeformat={execCommand:function(e,t,n,r,i){function h(e){if(e.nodeType==3||e.tagName.toLowerCase()!="span")return 0;if(browser.ie){var t=e.attributes;if(t.length){for(var n=0,r=t.length;n<r;n++)if(t[n].specified)return 0;return 1}}return!e.attributes.length}function p(e){var t=e.createBookmark();e.collapsed&&e.enlarge(!0);if(!i){var r=domUtils.findParentByTagName(e.startContainer,"a",!0);r&&e.setStartBefore(r);r=domUtils.findParentByTagName(e.endContainer,"a",!0);r&&e.setEndAfter(r)}a=e.createBookmark();d=a.start;while((l=d.parentNode)&&!domUtils.isBlockElm(l)){domUtils.breakParent(d,l);domUtils.clearEmptySibling(d)}if(a.end){d=a.end;while((l=d.parentNode)&&!domUtils.isBlockElm(l)){domUtils.breakParent(d,l);domUtils.clearEmptySibling(d)}var u=domUtils.getNextDomNode(a.start,!1,c),f;while(u){if(u==a.end)break;f=domUtils.getNextDomNode(u,!0,c);if(!dtd.$empty[u.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(u))if(s.test(u.tagName))if(n){domUtils.removeStyle(u,n);h(u)&&n!="text-decoration"&&domUtils.remove(u,!0)}else domUtils.remove(u,!0);else if(!dtd.$tableContent[u.tagName]&&!dtd.$list[u.tagName]){domUtils.removeAttributes(u,o);h(u)&&domUtils.remove(u,!0)}u=f}}var p=a.start.parentNode;domUtils.isBlockElm(p)&&!dtd.$tableContent[p.tagName]&&!dtd.$list[p.tagName]&&domUtils.removeAttributes(p,o);p=a.end.parentNode;a.end&&domUtils.isBlockElm(p)&&!dtd.$tableContent[p.tagName]&&!dtd.$list[p.tagName]&&domUtils.removeAttributes(p,o);e.moveToBookmark(a).moveToBookmark(t);var d=e.startContainer,v,m=e.collapsed;while(d.nodeType==1&&domUtils.isEmptyNode(d)&&dtd.$removeEmpty[d.tagName]){v=d.parentNode;e.setStartBefore(d);e.startContainer===e.endContainer&&e.endOffset--;domUtils.remove(d);d=v}if(!m){d=e.endContainer;while(d.nodeType==1&&domUtils.isEmptyNode(d)&&dtd.$removeEmpty[d.tagName]){v=d.parentNode;e.setEndBefore(d);domUtils.remove(d);d=v}}}var s=new RegExp("^(?:"+(t||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),o=n?[]:(r||this.options.removeFormatAttributes).split(","),u=new dom.Range(this.document),a,f,l,c=function(e){return e.nodeType==1};u=this.selection.getRange();p(u);u.select()}}};UE.plugins.font=function(){var e=this,t={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"};e.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});for(var n in t)(function(e,t){UE.commands[e]={execCommand:function(n,r){r=r||(this.queryCommandState(n)?"none":n=="underline"?"underline":"line-through");var i=this,s=this.selection.getRange(),o;if(r=="default"){if(s.collapsed){o=i.document.createTextNode("font");s.insertNode(o).select()}i.execCommand("removeFormat","span,a",t);if(o){s.setStartBefore(o).setCursor();domUtils.remove(o)}}else if(!s.collapsed){(e=="underline"||e=="strikethrough")&&i.queryCommandValue(e)&&i.execCommand("removeFormat","span,a",t);s=i.selection.getRange();s.applyInlineStyle("span",{style:t+":"+r}).select()}else{var u=domUtils.findParentByTagName(s.startContainer,"span",!0);o=i.document.createTextNode("font");if(u&&!u.children.length&&!u[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){s.insertNode(o);if(e=="underline"||e=="strikethrough"){s.selectNode(o).select();i.execCommand("removeFormat","span,a",t,null);u=domUtils.findParentByTagName(o,"span",!0);s.setStartBefore(o)}u.style.cssText+=";"+t+":"+r;s.collapse(!0).select()}else{s.insertNode(o);s.selectNode(o).select();u=s.document.createElement("span");if(e=="underline"||e=="strikethrough"){if(domUtils.findParentByTagName(o,"a",!0)){s.setStartBefore(o).setCursor();domUtils.remove(o);return}i.execCommand("removeFormat","span,a",t)}u.style.cssText=t+":"+r;o.parentNode.insertBefore(u,o);if(!browser.ie||browser.ie&&browser.version==9){var a=u.parentNode;while(!domUtils.isBlockElm(a)){a.tagName=="SPAN"&&(u.style.cssText=a.style.cssText+";"+u.style.cssText);a=a.parentNode}}opera?setTimeout(function(){s.setStart(u,0).setCursor()}):s.setStart(u,0).setCursor()}domUtils.remove(o)}return!0},queryCommandValue:function(e){var n=this.selection.getStart();if(e=="underline"||e=="strikethrough"){var r=n,i;while(r&&!domUtils.isBlockElm(r)&&!domUtils.isBody(r)){if(r.nodeType==1){i=domUtils.getComputedStyle(r,t);if(i!="none")return i}r=r.parentNode}return"none"}return domUtils.getComputedStyle(n,t)},queryCommandState:function(e){return e!="underline"&&e!="strikethrough"?0:this.queryCommandValue(e)==(e=="underline"?"underline":"line-through")}}})(n,t[n])};UE.plugins.justify=function(){var e=this,t=domUtils.isBlockElm,n={left:1,right:1,center:1,justify:1},r=function(e,n){var r=e.createBookmark(),i=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)};e.enlarge(!0);var s=e.createBookmark(),o=domUtils.getNextDomNode(s.start,!1,i),u=e.cloneRange(),a;while(o&&!(domUtils.getPosition(o,s.end)&domUtils.POSITION_FOLLOWING))if(o.nodeType==3||!t(o)){u.setStartBefore(o);while(o&&o!==s.end&&!t(o)){a=o;o=domUtils.getNextDomNode(o,!1,null,function(e){return!t(e)})}u.setEndAfter(a);var f=u.getCommonAncestor();if(!domUtils.isBody(f)&&t(f)){domUtils.setStyles(f,utils.isString(n)?{"text-align":n}:n);o=f}else{var l=e.document.createElement("p");domUtils.setStyles(l,utils.isString(n)?{"text-align":n}:n);var c=u.extractContents();l.appendChild(c);u.insertNode(l);o=l}o=domUtils.getNextDomNode(o,!1,i)}else o=domUtils.getNextDomNode(o,!0,i);return e.moveToBookmark(s).moveToBookmark(r)};UE.commands.justify={execCommand:function(e,t){var n=this.selection.getRange(),i;if(n.collapsed){i=this.document.createTextNode("p");n.insertNode(i)}r(n,t);if(i){n.setStartBefore(i).collapse(!0);domUtils.remove(i)}n.select();return!0},queryCommandValue:function(){var e=this.selection.getStart(),t=domUtils.getComputedStyle(e,"text-align");return n[t]?t:"left"},queryCommandState:function(){var e=this.selection.getStart(),t=e&&domUtils.findParentByTagName(e,["td","th","caption"],!0);return t?-1:0}}};UE.plugins.autofloat=function(){function u(e){if(!
e.ui){alert(t.autofloatMsg);return 0}return 1}function a(){var e=document.body.style;e.backgroundImage='url("about:blank")';e.backgroundAttachment="fixed"}function v(){var t=domUtils.getXY(c),n=domUtils.getComputedStyle(c,"position"),i=domUtils.getComputedStyle(c,"left");c.style.width=c.offsetWidth+"px";c.style.zIndex=e.options.zIndex*1+1;c.parentNode.insertBefore(l,c);if(s||o&&browser.ie){c.style.position!="absolute"&&(c.style.position="absolute");c.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-h+r+"px"}else{if(browser.ie7Compat&&d){d=!1;c.style.left=domUtils.getXY(c).x-document.documentElement.getBoundingClientRect().left+2+"px"}if(c.style.position!="fixed"){c.style.position="fixed";c.style.top=r+"px";(n=="absolute"||n=="relative")&&parseFloat(i)&&(c.style.left=t.x+"px")}}}function m(){d=!0;l.parentNode&&l.parentNode.removeChild(l);c.style.cssText=f}function g(){var t=p(e.container);t.top<0&&t.bottom-c.offsetHeight>0?v():m()}var e=this,t=e.getLang();e.setOpt({topOffset:0});var n=e.options.autoFloatEnabled!==!1,r=e.options.topOffset;if(!n)return;var i=UE.ui.uiUtils,s=browser.ie&&browser.version<=6,o=browser.quirks,f,l=document.createElement("div"),c,h,p,d=!0,y=utils.defer(function(){g()},browser.ie?200:100,!0);e.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],g);e.removeListener("keydown",y)});e.addListener("ready",function(){if(u(e)){p=i.getClientRect;c=e.ui.getDom("toolbarbox");h=p(c).top;f=c.style.cssText;l.style.height=c.offsetHeight+"px";s&&a();domUtils.on(window,["scroll","resize"],g);e.addListener("keydown",y);e.addListener("beforefullscreenchange",function(e,t){t&&m()});e.addListener("fullscreenchanged",function(e,t){t||g()});e.addListener("sourcemodechanged",function(e,t){setTimeout(function(){g()},0)});e.addListener("clearDoc",function(){setTimeout(function(){g()},0)})}})};UE.plugins.autoheight=function(){function a(){var e=this;clearTimeout(u);if(f)return;u=setTimeout(function(){if(e.queryCommandState&&e.queryCommandState("source")!=1){if(!n){n=e.document.createElement("span");n.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;";n.innerHTML="."}r=n.cloneNode(!0);e.body.appendChild(r);o=Math.max(domUtils.getXY(r).y+r.offsetHeight,Math.max(s.minFrameHeight,s.initialFrameHeight));if(o!=i){e.setHeight(o);i=o}domUtils.remove(r)}},50)}var e=this;e.autoHeightEnabled=e.options.autoHeightEnabled!==!1;if(!e.autoHeightEnabled)return;var t,n,r,i=0,s=e.options,o,u,f;e.addListener("fullscreenchanged",function(e,t){f=t});e.addListener("destroy",function(){e.removeListener("contentchange",a);e.removeListener("afterinserthtml",a);e.removeListener("keyup",a);e.removeListener("mouseup",a)});e.enableAutoHeight=function(){if(!e.autoHeightEnabled)return;var n=e.document;e.autoHeightEnabled=!0;t=n.body.style.overflowY;n.body.style.overflowY="hidden";e.addListener("contentchange",a);e.addListener("afterinserthtml",a);e.addListener("keyup",a);e.addListener("mouseup",a);setTimeout(function(){a.call(this)},browser.gecko?100:0);e.fireEvent("autoheightchanged",e.autoHeightEnabled)};e.disableAutoHeight=function(){e.body.style.overflowY=t||"";e.removeListener("contentchange",a);e.removeListener("keyup",a);e.removeListener("mouseup",a);e.autoHeightEnabled=!1;e.fireEvent("autoheightchanged",e.autoHeightEnabled)};e.addListener("ready",function(){e.enableAutoHeight();var t;domUtils.on(browser.ie?e.body:e.document,browser.webkit?"dragover":"drop",function(){clearTimeout(t);t=setTimeout(function(){a.call(this)},100)})})};UE.plugins.autolink=function(){var e=0;if(browser.ie)return;var t=this;t.addListener("reset",function(){e=0});t.addListener("keydown",function(e,n){var r=n.keyCode||n.which;if(r==32||r==13){var i=t.selection.getNative(),s=i.getRangeAt(0).cloneRange(),o,u,a=s.startContainer;while(a.nodeType==1&&s.startOffset>0){a=s.startContainer.childNodes[s.startOffset-1];if(!a)break;s.setStart(a,a.nodeType==1?a.childNodes.length:a.nodeValue.length);s.collapse(!0);a=s.startContainer}do{if(s.startOffset==0){a=s.startContainer.previousSibling;while(a&&a.nodeType==1)a=a.lastChild;if(!a||domUtils.isFillChar(a))break;o=a.nodeValue.length}else{a=s.startContainer;o=s.startOffset}s.setStart(a,o-1);u=s.toString().charCodeAt(0)}while(u!=160&&u!=32);if(s.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(s.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(s.toString()))break;try{s.setStart(s.startContainer,s.startOffset+1)}catch(f){var a=s.startContainer;while(!(next=a.nextSibling)){if(domUtils.isBody(a))return;a=a.parentNode}s.setStart(next,0)}}if(domUtils.findParentByTagName(s.startContainer,"a",!0))return;var l=t.document.createElement("a"),c=t.document.createTextNode(" "),h;t.undoManger&&t.undoManger.save();l.appendChild(s.extractContents());l.href=l.innerHTML=l.innerHTML.replace(/<[^>]+>/g,"");h=l.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),"");h=/^(?:https?:\/\/)/ig.test(h)?h:"http://"+h;l.setAttribute("data_ue_src",utils.html(h));l.href=utils.html(h);s.insertNode(l);l.parentNode.insertBefore(c,l.nextSibling);s.setStart(c,0);s.collapse(!0);i.removeAllRanges();i.addRange(s);t.undoManger&&t.undoManger.save()}}})};UE.plugins.autosubmit=function(){var e=this;e.commands.autosubmit={execCommand:function(){var e=this,t=domUtils.findParentByTagName(e.iframe,"form",!1);if(t){if(e.fireEvent("beforesubmit")===!1)return;e.sync();t.submit()}}};e.addshortcutkey({autosubmit:"ctrl+13"})};UE.plugins.catchremoteimage=function(){function catchremoteimage(e,t){var n=e.join(separater),r={timeout:6e4,onsuccess:t.success,onerror:t.error};r[me.options.catchFieldName]=n;ajax.request(catcherUrl,r)}if(this.options.catchRemoteImageEnable===!1)return;var me=this;this.setOpt({localDomain:["127.0.0.1","localhost","img.baidu.com"],separater:"ue_separate_ue",catchFieldName:"upfile",catchRemoteImageEnable:!0});var ajax=UE.ajax,localDomain=me.options.localDomain,catcherUrl=me.options.catcherUrl,separater=me.options.separater;me.addListener("afterpaste",function(){me.fireEvent("catchRemoteImage")});me.addListener("catchRemoteImage",function(){var remoteImages=[],imgs=domUtils.getElementsByTagName(me.document,"img"),test=function(e,t){for(var n=0,r;r=t[n++];)if(e.indexOf(r)!==-1)return!0;return!1};for(var i=0,ci;ci=imgs[i++];){if(ci.getAttribute("word_img"))continue;var src=ci.getAttribute("data_ue_src")||ci.src||"";/^(https?|ftp):/i.test(src)&&!test(src,localDomain)&&remoteImages.push(src)}remoteImages.length&&catchremoteimage(remoteImages,{success:function(xhr){try{var info=eval("("+xhr.responseText+")")}catch(e){return}var srcUrls=info.srcUrl.split(separater),urls=info.url.split(separater);for(var i=0,ci;ci=imgs[i++];){var src=ci.getAttribute("data_ue_src")||ci.src||"";for(var j=0,cj;cj=srcUrls[j++];){var url=urls[j-1];if(src==cj&&url!="error"){var newSrc=me.options.catcherPath+url;domUtils.setAttributes(ci,{src:newSrc,data_ue_src:newSrc});break}}}me.fireEvent("catchremotesuccess")},error:function(){me.fireEvent("catchremoteerror")}})})};UE.plugins.wordcount=function(){var e=this;e.addListener("contentchange",function(){e.fireEvent("wordcount")});var t;e.addListener("keyup",function(){clearTimeout(t);var e=this;t=setTimeout(function(){e.fireEvent("wordcount")},200)})};UE.plugins.elementpath=function(){var e,t,n=this;n.setOpt("elementPathEnabled",!0);if(!n.options.elementPathEnabled)return;n.commands.elementpath={execCommand:function(r,i){var s=t[i],o=n.selection.getRange();e=i*1;o.selectNode(s).select()},queryCommandValue:function(){var n=[].concat(this.selection.getStartElementPath()).reverse(),r=[];t=n;for(var i=0,s;s=n[i];i++){if(s.nodeType==3)continue;var o=s.tagName.toLowerCase();o=="img"&&s.getAttribute("anchorname")&&(o="anchor");r[i]=o;if(e==i){e=-1;break}}return r}}};UE.commands.insertparagraph={execCommand:function(e,t){var n=this,r=n.selection.getRange(),i=r.startContainer,s;while(i){if(domUtils.isBody(i))break;s=i;i=i.parentNode}if(s){var o=n.document.createElement("p");t?s.parentNode.insertBefore(o,s):s.parentNode.insertBefore(o,s.nextSibling);domUtils.fillNode(n.document,o);r.setStart(o,0).setCursor(!1,!0)}}};